{"version":3,"sources":["state/DragSubject.ts","tools/Anim.ts","tools/Vec.ts","tools/Pose.ts","tools/index.ts","state/state.ts","state/actions.ts","steps/locations.ts","hooks/useAnimation.ts","DebugPoints.tsx","Canvas.tsx","hooks/useDims.ts","hooks/useMouse.ts","Controls.tsx","ControlPoints.tsx","MainTriangle.tsx","Measurement.tsx","steps/step1.tsx","Polygon.tsx","steps/step2.tsx","steps/step4.tsx","PosedPolygon.tsx","steps/step7.tsx","steps/index.ts","steps/step3.tsx","steps/step5.tsx","steps/step6.tsx","steps/step8.tsx","steps/step9.tsx","state/reducer.ts","state/selectors.ts","state/index.ts","assets/sonobe.svg","Header.tsx","Prose.tsx","MainTriangleReset.tsx","Illustration.tsx","Footer.tsx","App.tsx","index.tsx"],"names":["Type","DragSubject","type","hOffset","vOffset","handlers","this","None","none","RVertex","r","HVertex","h","VVertex","v","out","Anim","fn","duration","after","t","value","from","to","EaseNumber","EaseVector","anims","durations","Object","values","map","keys","reduce","acc","key","Math","max","diff","tNorm","plus","times","Extras","SvgPath","pts","pts1","segmentDuration","length","seg","floor","pos","minus","fixed","slice","pt","x","y","join","Measurement","start","end","crossLength","crossDuration","lineDuration","mainLine","perp","norm","crossStart1","crossStart2","crossEnd1","crossEnd2","fullCross","crossStartPath","linePath","crossEndPath","crossPos","linePos","Vec","rhs","scalar","sqrt","Error","denom","dot","num","angle","cos","sin","Pose","loc","sign","n","memo","cachedInput","cachedOutput","ActionType","initTri","initState","ui","dims","width","height","triOutOfBounds","tri","dragSubject","stepIndex","previousStep","PreviousStep","nextStep","NextStep","mouseDownRVertex","MouseDownRVertex","mouseDownHVertex","MouseDownHVertex","mouseDownVVertex","MouseDownVVertex","mouseMove","MouseMove","payload","mouseUp","MouseUp","makeThin","MakeThin","makeEven","MakeEven","updateDims","UpdateDims","resetMainTriangle","ResetMainTriangle","vr","hr","vh","rv","rh","aPerpNorm","aPerp","a0","a1","aSquare","aSquareLabel","half","bPerpNorm","bPerp","b0","b1","bSquare","bSquareLabel","cPerpNorm","vh1","vr1","proj","cPerp","c0","c1","cSquare","cSquareLabel","abOut","abIn","cAuxV","hrLength","vert","cAuxDiag","rh1","cAuxH","vrLength","horiz","SIDE_MEASURE_OFFSET","aMeasurementPerp","aMeasurementStart","aMeasurementEnd","bMeasurementPerp","bMeasurementStart","bMeasurementEnd","cMeasurementPerp","cMeasurementStart","cMeasurementEnd","SIDE_LABEL_OFFSET","aMeasurementLabel","bMeasurementLabel","cMeasurementLabel","abAuxSquare","cAuxSquare","abMeasurementHOut","vA0","abMeasurementVOut","hB1","aSquareMeasurement1Start","aSquareMeasurement1End","bSquareMeasurement1Start","bSquareMeasurement1End","aSquareMeasurement1Label","bSquareMeasurement1Label","aSquareMeasurement2Start","aSquareMeasurement2End","bSquareMeasurement2Start","bSquareMeasurement2End","aSquareMeasurement2Label","bSquareMeasurement2Label","isRightHanded","cross","initTriPose","triCopyPts","triCopyC1Pose","PI","triCopyC2Pose","triCopyC3Pose","triCopyAB1Pose","triCopyAB2Pose","triCopyAB3Pose","cMeasurementVOut","cMeasurementHOut","cSquareMeasurementA1Start","cSquareMeasurementA1End","cSquareMeasurementB1Start","cSquareMeasurementB1End","cSquareMeasurementA1Label","cSquareMeasurementB1Label","cSquareMeasurementA2Start","cSquareMeasurementA2End","cSquareMeasurementB2Start","cSquareMeasurementB2End","cSquareMeasurementA2Label","cSquareMeasurementB2Label","useAnimationFrame","rafHandle","React","useRef","pausedFrame","useState","isPlaying","setIsPlaying","frame","setFrame","step","useCallback","timestamp","undefined","current","currentFrame","window","requestAnimationFrame","useEffect","cancelAnimationFrame","togglePlay","updateFrame","restart","DebugPoint","props","name","className","dx","dy","cx","cy","DebugPolygon","d","DebugPoints","useContext","StateContext","state","L","Canvas","dispatch","ref","onChange","setDims","computeDims","getBoundingClientRect","addEventListener","removeEventListener","useDims","A","S","centerX","centerY","left","top","bounds","setBounds","onMove","onUp","computeBounds","handleMove","e","clientX","clientY","document","handleUp","useMouse","translation","id","xmlns","transform","children","debug","Controls","buttonText","onClick","min","Number","target","ControlPoints","rOpacity","hOpacity","vOpacity","fillOpacity","onMouseDown","MainTriangle","fullPath","opacity","strokeOpacity","label","labelPos","labelOpacity","textAnchor","dominantBaseline","Polygon","SquareLabel","side","PosedPolygon","pose","rotate","steps","section","graphics","controlPoints","useMemo","Fork","Ease","Wait","then","triangle","AnimExtras","animTriangle","measurements","dA","aOpacity","dB","bOpacity","dC","cOpacity","animControls","aLabelPos","bLabelPos","cLabelPos","squares","labels","aLabelOpacity","bLabelOpacity","cLabelOpacity","auxSquares","abPath","cPath","dA1","a1Opacity","dB1","b1Opacity","dA2","a2Opacity","dB2","b2Opacity","aLabel1Pos","bLabel1Pos","aLabel2Pos","bLabel2Pos","triCopies","initPose","copy1Pose","copy2Pose","copy3Pose","tri1Pose","tri1Opacity","tri2Pose","tri2Opacity","tri3Pose","tri3Opacity","animTriCopies","triPts","triOpacity","mainTriOpacity","reducer","action","reducePreviousStep","reduceNextStep","reduceMouseDownRVertex","reduceMouseDownHVertex","reduceMouseDownVVertex","mousePos","match","moveRVertex","hX","abs","VERTEX_PADDING","hY","newH","newR","moveHVertex","vX","vY","newV","moveVVertex","reduceMouseMove","isTriOutOfBounds","reduceMouseUp","reduceMakeThin","reduceMakeEven","reduceUpdateDims","reduceResetMainTriangle","outX","outY","canGoPrevious","canGoNext","stepProgress","currentSection","currentGraphics","createContext","Header","href","rel","src","sonobe","alt","Prose","Section","MainTriangleReset","Illustration","Graphics","Footer","noPrevious","noNext","disabled","App","useReducer","Provider","ReactDOM","render","StrictMode","getElementById"],"mappings":"gtJA6CKA,E,8DA7CQC,EAAb,iDACUC,UADV,OAEUC,aAFV,OAGUC,aAHV,2CA+BE,SAASC,GACP,OAAQC,KAAKJ,MACX,KAAKF,EAAKO,KACR,OAAOF,EAASG,OAClB,KAAKR,EAAKS,QACR,OAAOJ,EAASK,EAAEJ,KAAKH,QAAmBG,KAAKF,SACjD,KAAKJ,EAAKW,QACR,OAAON,EAASO,IAClB,KAAKZ,EAAKa,QACR,OAAOR,EAASS,QAxCxB,mBAKE,WACE,IAAMC,EAAM,IAAId,EAEhB,OADAc,EAAIb,KAAOF,EAAKO,KACTQ,IARX,qBAWE,SAAeZ,EAAiBC,GAC9B,IAAMW,EAAM,IAAId,EAIhB,OAHAc,EAAIb,KAAOF,EAAKS,QAChBM,EAAIZ,QAAUA,EACdY,EAAIX,QAAUA,EACPW,IAhBX,qBAmBE,WACE,IAAMA,EAAM,IAAId,EAEhB,OADAc,EAAIb,KAAOF,EAAKW,QACTI,IAtBX,qBAyBE,WACE,IAAMA,EAAM,IAAId,EAEhB,OADAc,EAAIb,KAAOF,EAAKa,QACTE,MA5BX,M,SA6CKf,K,YAAAA,E,kBAAAA,E,kBAAAA,E,mBAAAA,M,+BC3CQgB,EAAb,WACE,WAAmBC,EAA4BC,GAAmB,yBAA/CD,KAA8C,KAAlBC,WADjD,wCAGE,SAAKC,GAA0B,IAAD,OAC5B,OAAO,IAAIH,GAAK,SAAAI,GACd,OAAIA,EAAI,EAAKF,SACJ,EAAKD,GAAGG,GAERD,EAAMF,GAAGG,EAAI,EAAKF,YAE1BZ,KAAKY,SAAWC,EAAMD,aAV7B,mBAaE,SAAeG,EAAUH,GACvB,OAAO,IAAIF,GAAK,SAAAI,GAAC,OAAIC,IAAOH,KAdhC,kBAiBE,SACEI,EACAC,EACAL,GAEA,MAAoB,kBAATI,GAAmC,kBAAPC,EAC9BP,EAAKQ,WAAWF,EAAMC,EAAIL,GAE1BF,EAAKS,WAAWH,EAAgBC,EAAcL,KAzB3D,kBA6BE,SAAeQ,GACb,IAAMC,EAAYC,OAAOC,OAAOH,GAAOI,KAAI,qBAAGZ,YAG9C,OAAO,IAAIF,GAAK,SAAAI,GAQd,OAPYQ,OAAOG,KAAKL,GAAOM,QAC7B,SAACC,EAAKC,GAAN,mBAAC,eACID,GADL,kBAEGC,EAAMR,EAAMQ,GAAKjB,GAAGG,OAEvB,MARae,KAAKC,IAAL,MAAAD,KAAI,YAAQR,GAAR,QAAmB,QA/B5C,wBA6CE,SACEL,EACAC,EACAL,GAEA,IAAMmB,EAAOd,EAAKD,EAClB,OAAO,IAAIN,GAAK,SAAAI,GACd,GAAIA,EAAIF,EAAU,CAChB,IAAMoB,EAAQlB,EAAIF,EAClB,OAAOI,EAAOe,EAAOC,EAAQA,GAAS,EAAI,EAAIA,GAE9C,OAAOf,IAERL,KA1DP,wBA6DE,SACEI,EACAC,EACAL,GAEA,IAAMmB,EAAOd,EAAGgB,KAAKjB,EAAKkB,OAAO,IACjC,OAAO,IAAIxB,GAAK,SAAAI,GACd,GAAIA,EAAIF,EAAU,CAChB,IAAMoB,EAAQlB,EAAIF,EAClB,OAAOI,EAAKiB,KAAKF,EAAKG,MAAMF,EAAQA,GAAS,EAAI,EAAIA,KAErD,OAAOf,IAERL,OA1EP,KAmKO,IAAMuB,EAAS,CACpBC,QA7EF,SAAqBC,EAAYzB,GAC/B,IAAM0B,EAAI,sBAAOD,GAAP,CAAYA,EAAI,KACpBE,EAAkB3B,GAAY0B,EAAKE,OAAS,GAElD,OAAO,IAAI9B,GAAK,SAAAI,GACd,GAAIA,EAAIF,EAAU,CAChB,IAAM6B,EAAMZ,KAAKa,MAAM5B,EAAIyB,GACrBvB,EAAOsB,EAAKG,GACZxB,EAAKqB,EAAKG,EAAM,GAChBT,GAASlB,EAAI2B,EAAMF,GAAmBA,EACtCI,EAAM3B,EAAKiB,KACfhB,EAAG2B,MAAM5B,GAAMkB,MAAMF,EAAQA,GAAS,EAAI,EAAIA,KAE1Ca,EAAQP,EACXQ,MAAM,EAAGL,EAAM,GACfjB,KAAI,SAAAuB,GAAE,gBAAOA,EAAGC,EAAV,YAAeD,EAAGE,MACxBC,KAAK,OACR,MAAM,KAAN,OAAYL,EAAZ,cAAuBF,EAAIK,EAA3B,YAAgCL,EAAIM,GAEpC,MAAM,KAAN,OAAYZ,EAAIb,KAAI,SAAAuB,GAAE,gBAAOA,EAAGC,EAAV,YAAeD,EAAGE,MAAKC,KAAK,OAAlD,QAEDtC,IAyDHuC,YAtDF,SACEC,EACAC,EACAC,EACA1C,GAEA,IAAM2C,EAAgB,GAAM3C,EACtB4C,EAAe,GAAM5C,EAErB6C,EAAWJ,EAAIT,MAAMQ,GACrBM,EAAOD,EACVC,OACAC,OACAzB,MAAMoB,EAAc,GACjBM,EAAcR,EAAMnB,KAAKyB,GACzBG,EAAcT,EAAMR,MAAMc,GAC1BI,EAAYT,EAAIpB,KAAKyB,GACrBK,EAAYV,EAAIT,MAAMc,GACtBM,EAAYN,EAAKxB,OAAO,GAExB+B,EAAc,YAAQL,EAAYZ,EAApB,YAAyBY,EAAYX,EAArC,cAA4CY,EAAYb,EAAxD,YAA6Da,EAAYZ,GACvFiB,EAAQ,YAAQd,EAAMJ,EAAd,YAAmBI,EAAMH,EAAzB,cAAgCI,EAAIL,EAApC,YAAyCK,EAAIJ,GACrDkB,EAAY,YAAQL,EAAUd,EAAlB,YAAuBc,EAAUb,EAAjC,cAAwCc,EAAUf,EAAlD,YAAuDe,EAAUd,GAEnF,OAAO,IAAIvC,GAAK,SAAAI,GACd,GAAIA,EAAIyC,EAAe,CAErB,IAAMvB,EAAQlB,EAAIyC,EACZa,EAAWR,EAAY3B,KAAK+B,EAAU9B,MAAMF,IAClD,MAAM,KAAN,OAAY4B,EAAYZ,EAAxB,YAA6BY,EAAYX,EAAzC,cAAgDmB,EAASpB,EAAzD,YAA8DoB,EAASnB,GAClE,GAAIM,GAAiBzC,GAAKA,EAAIyC,EAAgBC,EAAc,CAEjE,IAAMxB,GAASlB,EAAIyC,GAAiBC,EAC9Ba,EAAUjB,EAAMnB,KACpBwB,EAASvB,MAAMF,EAAQA,GAAS,EAAI,EAAIA,KAE1C,MAAM,GAAN,OAAUiC,EAAV,cAA8Bb,EAAMJ,EAApC,YAAyCI,EAAMH,EAA/C,cAAsDoB,EAAQrB,EAA9D,YAAmEqB,EAAQpB,GACtE,GACLM,EAAgBC,GAAgB1C,GAChCA,EAAIyC,EAAgBC,EAAeD,EACnC,CAEA,IAAMvB,GAASlB,EAAIyC,EAAgBC,GAAgBD,EAC7Ca,EAAWN,EAAU7B,KAAK+B,EAAU9B,MAAMF,IAChD,MAAM,GAAN,OAAUiC,EAAV,YAA4BC,EAA5B,cAA0CJ,EAAUd,EAApD,YAAyDc,EAAUb,EAAnE,cAA0EmB,EAASpB,EAAnF,YAAwFoB,EAASnB,GAGjG,MAAM,GAAN,OAAUgB,EAAV,YAA4BC,EAA5B,YAAwCC,KAEzCvD,KChKQ0D,EAAb,WACE,WAAmBtB,EAAkBC,GAAY,yBAA9BD,IAA6B,KAAXC,IADvC,wCAGE,SAAKsB,GACH,OAAO,IAAID,EAAItE,KAAKgD,EAAIuB,EAAIvB,EAAGhD,KAAKiD,EAAIsB,EAAItB,KAJhD,mBAOE,SAAMuB,GACJ,OAAO,IAAIF,EAAIE,EAASxE,KAAKgD,EAAGwB,EAASxE,KAAKiD,KARlD,mBAWE,SAAMsB,GACJ,OAAO,IAAID,EAAItE,KAAKgD,EAAIuB,EAAIvB,EAAGhD,KAAKiD,EAAIsB,EAAItB,KAZhD,oBAeE,WACE,OAAOpB,KAAK4C,KAAKzE,KAAKgD,EAAIhD,KAAKgD,EAAIhD,KAAKiD,EAAIjD,KAAKiD,KAhBrD,kBAmBE,WACE,IAAMT,EAASxC,KAAKwC,SACpB,GAAe,IAAXA,EACF,MAAM,IAAIkC,MAAM,4BAGlB,OAAO1E,KAAKkC,MAAM,EAAIM,KAzB1B,iBA4BE,SAAI+B,GACF,OAAOvE,KAAKgD,EAAIuB,EAAIvB,EAAIhD,KAAKiD,EAAIsB,EAAItB,IA7BzC,kBAgCE,SAAKsB,GACH,IAAMI,EAAQJ,EAAIK,IAAIL,GACtB,GAAc,IAAVI,EACF,MAAM,IAAID,MAAM,wCAGlB,IAAMG,EAAM7E,KAAK4E,IAAIL,GACrB,OAAOA,EAAIrC,MAAM2C,EAAMF,KAvC3B,kBA0CE,WACE,OAAO,IAAIL,GAAKtE,KAAKiD,EAAGjD,KAAKgD,KA3CjC,oBA8CE,SAAO8B,GACL,IAAQ9B,EAAShD,KAATgD,EAAGC,EAAMjD,KAANiD,EACL8B,EAAMlD,KAAKkD,IAAID,GACfE,EAAMnD,KAAKmD,IAAIF,GAErB,OAAO,IAAIR,EAAIS,EAAM/B,EAAIgC,EAAM/B,EAAG+B,EAAMhC,EAAI+B,EAAM9B,KAnDtD,mBAsDE,SAAMsB,GACJ,OAAOvE,KAAKgD,EAAIuB,EAAItB,EAAIjD,KAAKiD,EAAIsB,EAAIvB,MAvDzC,KCCaiC,EAAb,WACE,WAAmBC,EAAiBJ,GAAgB,yBAAjCI,MAAgC,KAAfJ,QADtC,wCAGE,SAAKP,GACH,OAAO,IAAIU,EAAKjF,KAAKkF,IAAIjD,KAAKsC,EAAIW,KAAMlF,KAAK8E,MAAQP,EAAIO,SAJ7D,mBAOE,SAAMN,GACJ,OAAO,IAAIS,EAAKjF,KAAKkF,IAAIhD,MAAMsC,GAASA,EAASxE,KAAK8E,WAR1D,KCCO,SAASK,EAAKC,GACnB,OAAIA,GAAK,EACA,GAEC,EAIL,SAASC,EAAW1E,GACzB,IAAI2E,EACAC,EAEJ,OAAO,SAACvC,GACN,OAAIsC,GAAeA,IAAgBtC,EAC1BuC,GAGTD,EAActC,EACduC,EAAe5E,EAAGqC,KCPf,ICPKwC,EDOCC,EAAyB,CACpCrF,EAAG,IAAIkE,GAAK,GAAI,GAChBhE,EAAG,IAAIgE,EAAI,GAAI,GACf9D,EAAG,IAAI8D,GAAK,IAAK,KAGNoB,EAAmB,CAC9BC,GAAI,CACFC,KAAM,CAAEC,MAAO,EAAGC,OAAQ,GAC1BC,gBAAgB,GAElBC,IAAKP,EACLQ,YAAatG,EAAYM,OACzBiG,UAAW,GCNN,SAASC,IACd,MAAO,CAAEvG,KAAM4F,EAAWY,cAGrB,SAASC,IACd,MAAO,CAAEzG,KAAM4F,EAAWc,UAGrB,SAASC,IACd,MAAO,CAAE3G,KAAM4F,EAAWgB,kBAGrB,SAASC,IACd,MAAO,CAAE7G,KAAM4F,EAAWkB,kBAGrB,SAASC,IACd,MAAO,CAAE/G,KAAM4F,EAAWoB,kBAGrB,SAASC,EAAUlE,GACxB,MAAO,CAAE/C,KAAM4F,EAAWsB,UAAWC,QAASpE,GAGzC,SAASqE,IACd,MAAO,CAAEpH,KAAM4F,EAAWyB,SAGrB,SAASC,IACd,MAAO,CAAEtH,KAAM4F,EAAW2B,UAGrB,SAASC,IACd,MAAO,CAAExH,KAAM4F,EAAW6B,UAGrB,SAASC,EAAW1B,GACzB,MAAO,CAAEhG,KAAM4F,EAAW+B,WAAYR,QAASnB,GAG1C,SAAS4B,IACd,MAAO,CAAE5H,KAAM4F,EAAWiC,oB,SAvDhBjC,K,4BAAAA,E,oBAAAA,E,oCAAAA,E,oCAAAA,E,oCAAAA,E,sBAAAA,E,kBAAAA,E,oBAAAA,E,oBAAAA,E,wBAAAA,E,uCAAAA,M,KCDL,IAAMkC,EAAoBrC,GAAK,SAAAW,GAAG,OAAIA,EAAI5F,EAAEwC,MAAMoD,EAAIxF,MAEhDmH,EAAoBtC,GAAK,SAAAW,GAAG,OAAIA,EAAI5F,EAAEwC,MAAMoD,EAAI1F,MAEhDsH,EAAoBvC,GAAK,SAAAW,GAAG,OAAIA,EAAI1F,EAAEsC,MAAMoD,EAAIxF,MAEhDqH,EAAoBxC,GAAK,SAAAW,GAAG,OAAI0B,EAAG1B,GAAK9D,OAAO,MAE/C4F,EAAoBzC,GAAK,SAAAW,GAAG,OAAI2B,EAAG3B,GAAK9D,OAAO,MAE/C6F,EAA2B1C,GAAK,SAAAW,GAC3C,OAAO2B,EAAG3B,GAAKrC,UAGJqE,EAAuB3C,GAAK,SAAAW,GACvC,IAAMxD,EAASkF,EAAG1B,GAAKxD,SACvB,OAAOuF,EAAU/B,GAAK9D,MAAMM,MAGjByF,EAAoB5C,GAAK,SAAAW,GACpC,OAAOA,EAAIxF,EAAEyB,KAAK+F,EAAMhC,OAGbkC,EAAoB7C,GAAK,SAAAW,GACpC,OAAOA,EAAI5F,EAAE6B,KAAK+F,EAAMhC,OAGbmC,EAA2B9C,GAAK,SAAAW,GAAG,MAAI,CAClDA,EAAIxF,EACJyH,EAAGjC,GACHkC,EAAGlC,GACHA,EAAI5F,MAGOgI,EAA8B/C,GAAK,SAAAW,GAC9C,IAAMqC,EAAOJ,EAAGjC,GACbpD,MAAMoD,EAAI5F,GACV8B,MAAM,IACT,OAAO8D,EAAI5F,EAAE6B,KAAKoG,MAGPC,EAA2BjD,GAAK,SAAAW,GAC3C,OAAO0B,EAAG1B,GAAKrC,UAGJ4E,EAAuBlD,GAAK,SAAAW,GACvC,IAAMxD,EAASmF,EAAG3B,GAAKxD,SACvB,OAAO8F,EAAUtC,GAAK9D,MAAMM,MAGjBgG,EAAoBnD,GAAK,SAAAW,GACpC,OAAOA,EAAI5F,EAAE6B,KAAKsG,EAAMvC,OAGbyC,EAAoBpD,GAAK,SAAAW,GACpC,OAAOA,EAAI1F,EAAE2B,KAAKsG,EAAMvC,OAGb0C,EAA2BrD,GAAK,SAAAW,GAAG,MAAI,CAClDA,EAAI5F,EACJoI,EAAGxC,GACHyC,EAAGzC,GACHA,EAAI1F,MAGOqI,GAA8BtD,GAAK,SAAAW,GAC9C,IAAMqC,EAAOG,EAAGxC,GACbpD,MAAMoD,EAAI1F,GACV4B,MAAM,IACT,OAAO8D,EAAI1F,EAAE2B,KAAKoG,MAGPO,GAA2BvD,GAAK,SAAAW,GAC3C,IAAM6C,EAAMjB,EAAG5B,GACT8C,EAAMpB,EAAG1B,GAEf,OADa8C,EAAIC,KAAKF,GACVjG,MAAMkG,GAAKnF,UAGZqF,GAAuB3D,GAAK,SAAAW,GACvC,IAAMxD,EAASoF,EAAG5B,GAAKxD,SACvB,OAAOoG,GAAU5C,GAAK9D,MAAMM,MAGjByG,GAAoB5D,GAAK,SAAAW,GACpC,OAAOA,EAAI1F,EAAE2B,KAAK+G,GAAMhD,OAGbkD,GAAoB7D,GAAK,SAAAW,GACpC,OAAOA,EAAIxF,EAAEyB,KAAK+G,GAAMhD,OAGbmD,GAA2B9D,GAAK,SAAAW,GAAG,MAAI,CAClDA,EAAI1F,EACJ2I,GAAGjD,GACHkD,GAAGlD,GACHA,EAAIxF,MAGO4I,GAA8B/D,GAAK,SAAAW,GAC9C,IAAMqC,EAAOY,GAAGjD,GACbpD,MAAMoD,EAAIxF,GACV0B,MAAM,IACT,OAAO8D,EAAIxF,EAAEyB,KAAKoG,MAGPgB,GAAuBhE,GAAK,SAAAW,GACvC,OAAOwC,EAAGxC,GAAK/D,KAAK+F,EAAMhC,OAGfsD,GAAsBjE,GAAK,SAAAW,GACtC,OAAOA,EAAI1F,EAAE2B,KAAK4F,EAAG7B,OAGVuD,GAAuBlE,GAAK,SAAAW,GACvC,IAAMwD,EAAW7B,EAAG3B,GAAKxD,SACnBiH,EAAO5B,EAAG7B,GAAKrC,OAAOzB,MAAMsH,GAClC,OAAOxD,EAAIxF,EAAEyB,KAAKwH,MAGPC,GAA0BrE,GAAK,SAAAW,GAC1C,IAAM2D,EAAM7B,EAAG9B,GACTxD,EAASmH,EAAInH,SAAWkF,EAAG1B,GAAKxD,SAChC/B,EAAMkJ,EAAIhG,OAAOzB,MAAMM,GAC7B,OAAO+G,GAAMvD,GAAK/D,KAAKxB,MAGZmJ,GAAuBvE,GAAK,SAAAW,GACvC,IAAM6D,EAAWnC,EAAG1B,GAAKxD,SACnBsH,EAAQhC,EAAG9B,GAAKrC,OAAOzB,MAAM2H,GACnC,OAAO7D,EAAI1F,EAAE2B,KAAK6H,MAGdC,GAAsB,GAEfC,GAAkC3E,GAAK,SAAAW,GAAG,OACrD+B,EAAU/B,GAAK9D,MAAM6H,OAGVE,GAAmC5E,GAAK,SAAAW,GAAG,OACtDA,EAAIxF,EAAEyB,KAAK+H,GAAiBhE,OAGjBkE,GAAiC7E,GAAK,SAAAW,GAAG,OACpDA,EAAI5F,EAAE6B,KAAK+H,GAAiBhE,OAGjBmE,GAAkC9E,GAAK,SAAAW,GAAG,OACrDsC,EAAUtC,GAAK9D,MAAM6H,OAGVK,GAAmC/E,GAAK,SAAAW,GAAG,OACtDA,EAAI5F,EAAE6B,KAAKkI,GAAiBnE,OAGjBqE,GAAiChF,GAAK,SAAAW,GAAG,OACpDA,EAAI1F,EAAE2B,KAAKkI,GAAiBnE,OAGjBsE,GAAkCjF,GAAK,SAAAW,GAAG,OACrD4C,GAAU5C,GAAK9D,MAAM6H,OAGVQ,GAAmClF,GAAK,SAAAW,GAAG,OACtDA,EAAI1F,EAAE2B,KAAKqI,GAAiBtE,OAGjBwE,GAAiCnF,GAAK,SAAAW,GAAG,OACpDA,EAAIxF,EAAEyB,KAAKqI,GAAiBtE,OAGxByE,GAAoB,GAEbC,GAAmCrF,GAAK,SAAAW,GACnD,IAAM5C,EAAQ6G,GAAkBjE,GAE1BqC,EADM6B,GAAgBlE,GACXpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAMsH,EAAU/B,GAAK9D,MAAMuI,IACjC,OAAOrH,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlBkK,GAAmCtF,GAAK,SAAAW,GACnD,IAAM5C,EAAQgH,GAAkBpE,GAE1BqC,EADMgC,GAAgBrE,GACXpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAM6H,EAAUtC,GAAK9D,MAAMuI,IACjC,OAAOrH,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlBmK,GAAmCvF,GAAK,SAAAW,GACnD,IAAM5C,EAAQmH,GAAkBvE,GAE1BqC,EADMmC,GAAgBxE,GACXpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAMmI,GAAU5C,GAAK9D,MAAMuI,IACjC,OAAOrH,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlBoK,GAA+BxF,GAAK,SAAAW,GAAG,MAAI,CACtDA,EAAIxF,EACJyH,EAAGjC,GACHqD,GAAMrD,GACNyC,EAAGzC,GACHsD,GAAKtD,OAGM8E,GAA8BzF,GAAK,SAAAW,GAAG,MAAI,CACrDA,EAAI5F,EACJmJ,GAAMvD,GACN0D,GAAS1D,GACT4D,GAAM5D,OAGK+E,GAAmC1F,GAAK,SAAAW,GACnD,IAAMgF,EAAM/C,EAAGjC,GAAKpD,MAAMoD,EAAIxF,GACxBC,EAAMuK,EAAIrH,OAAOzB,MAAM6H,IAC7B,OAAOiB,EAAI/I,KAAKxB,MAGLwK,GAAmC5F,GAAK,SAAAW,GACnD,IAAMkF,EAAMzC,EAAGzC,GAAKpD,MAAMoD,EAAI1F,GACxBG,EAAMyK,EAAIvH,OAAOzB,MAAM6H,IAC7B,OAAOmB,EAAIjJ,KAAKxB,MAGL0K,GAA0C9F,GAAK,SAAAW,GAAG,OAC7DA,EAAIxF,EAAEyB,KAAK8I,GAAkB/E,OAGlBoF,GAAwC/F,GAAK,SAAAW,GAAG,OAC3DA,EAAI5F,EAAE6B,KAAK8I,GAAkB/E,OAGlBqF,GAA0CD,GAE1CE,GAAwCjG,GAAK,SAAAW,GAAG,OAC3DwC,EAAGxC,GAAK/D,KAAK8I,GAAkB/E,OAGpBuF,GAA0ClG,GAAK,SAAAW,GAC1D,IAAM5C,EAAQ+H,GAAyBnF,GAEjCqC,EADM+C,GAAuBpF,GAClBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAMsH,EAAU/B,GAAK9D,MAAMuI,IACjC,OAAOrH,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlB+K,GAA0CnG,GAAK,SAAAW,GAC1D,IAAM5C,EAAQiI,GAAyBrF,GAEjCqC,EADMiD,GAAuBtF,GAClBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAMsH,EAAU/B,GAAK9D,MAAMuI,IACjC,OAAOrH,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlBgL,GAA0CpG,GAAK,SAAAW,GAAG,OAC7DkC,EAAGlC,GAAK/D,KAAKgJ,GAAkBjF,OAGpB0F,GAAwCrG,GAAK,SAAAW,GAAG,OAC3DA,EAAI5F,EAAE6B,KAAKgJ,GAAkBjF,OAGlB2F,GAA0CD,GAE1CE,GAAwCvG,GAAK,SAAAW,GAAG,OAC3DA,EAAI1F,EAAE2B,KAAKgJ,GAAkBjF,OAGlB6F,GAA0CxG,GAAK,SAAAW,GAC1D,IAAM5C,EAAQqI,GAAyBzF,GAEjCqC,EADMqD,GAAuB1F,GAClBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAM6H,EAAUtC,GAAK9D,MAAMuI,IACjC,OAAOrH,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlBqL,GAA0CzG,GAAK,SAAAW,GAC1D,IAAM5C,EAAQuI,GAAyB3F,GAEjCqC,EADMuD,GAAuB5F,GAClBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAM6H,EAAUtC,GAAK9D,MAAMuI,IACjC,OAAOrH,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlBsL,GAAmC1G,GAC9C,SAAAW,GAAG,OAAI8B,EAAG9B,GAAKgG,MAAMnE,EAAG7B,KAAS,KAGtBiG,GAA8B5G,GAAK,SAAAW,GAAG,OAAI,IAAIf,EAAKe,EAAI5F,EAAG,MAE1D8L,GAA8B7G,GAAK,SAAAW,GAAG,MAAI,CACrD,IAAI1B,EAAI,EAAG,GACXwD,EAAG9B,GACH6B,EAAG7B,OAGQmG,GAAgC9G,GAAK,SAAAW,GAChD,IAAMlB,EAAQiH,GAAc/F,IAAQnE,KAAKuK,GAAK,EAAIvK,KAAKuK,GAAK,EAC5D,OAAO,IAAInH,EAAKsE,GAAMvD,GAAMlB,MAGjBuH,GAAgChH,GAC3C,SAAAW,GAAG,OAAI,IAAIf,EAAKyE,GAAS1D,GAAMnE,KAAKuK,OAGzBE,GAAgCjH,GAAK,SAAAW,GAChD,IAAMlB,EAAQiH,GAAc/F,IAAS,EAAInE,KAAKuK,GAAM,EAAK,EAAIvK,KAAKuK,GAAM,EACxE,OAAO,IAAInH,EAAK2E,GAAM5D,GAAMlB,MAGjByH,GAAiClH,GAC5C,SAAAW,GAAG,OAAI,IAAIf,EAAKqE,GAAKtD,GAAMnE,KAAKuK,OAGrBI,GAAiCnH,GAAK,SAAAW,GACjD,IAAMlB,EAAQiH,GAAc/F,IAAQnE,KAAKuK,GAAK,EAAIvK,KAAKuK,GAAK,EAC5D,OAAO,IAAInH,EAAKiD,EAAGlC,GAAMlB,MAGd2H,GAAiCpH,GAAK,SAAAW,GACjD,IAAMlB,EAAQiH,GAAc/F,GAAOnE,KAAKuK,GAAK,GAAKvK,KAAKuK,GAAK,EAC5D,OAAO,IAAInH,EAAKuD,EAAGxC,GAAMlB,MAGd4H,GAAkCrH,GAAK,SAAAW,GAAG,OACrD6B,EAAG7B,GAAKrC,OAAOzB,MAAM6H,OAGV4C,GAAkCtH,GAAK,SAAAW,GAAG,OACrD8B,EAAG9B,GAAKrC,OAAOzB,MAAM6H,OAGV6C,GAA2CvH,GAAK,SAAAW,GAAG,OAC9DuD,GAAMvD,GAAK/D,KAAKyK,GAAiB1G,OAGtB6G,GAAyCxH,GAAK,SAAAW,GAAG,OAC5DkD,GAAGlD,GAAK/D,KAAKyK,GAAiB1G,OAGnB8G,GAA2CD,GAE3CE,GAAyC1H,GAAK,SAAAW,GAAG,OAC5D0D,GAAS1D,GAAK/D,KAAKyK,GAAiB1G,OAGzBgH,GAA2C3H,GAAK,SAAAW,GAC3D,IAAM5C,EAAQwJ,GAA0B5G,GAElCqC,EADMwE,GAAwB7G,GACnBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAM6H,EAAUtC,GAAK9D,OAAM,IACjC,OAAOkB,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlBwM,GAA2C5H,GAAK,SAAAW,GAC3D,IAAM5C,EAAQ0J,GAA0B9G,GAElCqC,EADM0E,GAAwB/G,GACnBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAM6H,EAAUtC,GAAK9D,OAAM,IACjC,OAAOkB,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlByM,GAA2C7H,GAAK,SAAAW,GAAG,OAC9D0D,GAAS1D,GAAK/D,KAAK0K,GAAiB3G,OAGzBmH,GAAyC9H,GAAK,SAAAW,GAAG,OAC5DiD,GAAGjD,GAAK/D,KAAK0K,GAAiB3G,OAGnBoH,GAA2CD,GAE3CE,GAAyChI,GAAK,SAAAW,GAAG,OAC5D4D,GAAM5D,GAAK/D,KAAK0K,GAAiB3G,OAGtBsH,GAA2CjI,GAAK,SAAAW,GAC3D,IAAM5C,EAAQ8J,GAA0BlH,GAElCqC,EADM8E,GAAwBnH,GACnBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAMsH,EAAU/B,GAAK9D,OAAM,IACjC,OAAOkB,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MAGlB8M,GAA2ClI,GAAK,SAAAW,GAC3D,IAAM5C,EAAQgK,GAA0BpH,GAElCqC,EADMgF,GAAwBrH,GACnBpD,MAAMQ,GAAOlB,MAAM,IAC9BzB,EAAMsH,EAAU/B,GAAK9D,OAAM,IACjC,OAAOkB,EAAMnB,KAAKoG,GAAMpG,KAAKxB,MC1YxB,SAAS+M,GAAkB5M,GAChC,IAAM6M,EAAYC,IAAMC,SAClBvK,EAAQsK,IAAMC,SACdC,EAAcF,IAAMC,OAAe,GACzC,EAAkCD,IAAMG,UAAS,GAAjD,mBAAOC,EAAP,KAAkBC,EAAlB,KACA,EAA0BL,IAAMG,SAAS,GAAzC,mBAAOG,EAAP,KAAcC,EAAd,KAEMC,EAAOR,IAAMS,aACjB,SAACC,QACuBC,IAAlBjL,EAAMkL,UACRlL,EAAMkL,QAAUF,GAGlB,IAAMG,EAAeH,EAAYhL,EAAMkL,QAAUV,EAAYU,QAC7DL,EAASM,GAELA,EAAe3N,IACjB6M,EAAUa,QAAUE,OAAOC,sBAAsBP,MAGrD,CAACtN,IAGH8M,IAAMgB,WAAU,WAKd,OAJAjB,EAAUa,QAAUE,OAAOC,sBAAsBP,GACjDN,EAAYU,QAAU,EACtBP,GAAa,GAEN,WACLS,OAAOG,qBAAqBlB,EAAUa,YAEvC,CAACJ,IAEJ,IAAMU,EAAalB,IAAMS,aAAY,WAC/BL,GACFC,GAAa,GACbH,EAAYU,QAAUN,EACtB5K,EAAMkL,aAAUD,EAChBG,OAAOG,qBAAqBlB,EAAUa,WAEtCP,GAAa,GACbN,EAAUa,QAAUE,OAAOC,sBAAsBP,MAElD,CAACJ,EAAWE,EAAOE,IAEhBW,EAAcnB,IAAMS,aAAY,SAACH,GACrCC,EAASD,GACTD,GAAa,GACbH,EAAYU,QAAUN,EACtB5K,EAAMkL,aAAUD,EAChBG,OAAOG,qBAAqBlB,EAAUa,WACrC,IAEGQ,EAAUpB,IAAMS,aAAY,WAChCF,EAAS,GACTF,GAAa,GACbH,EAAYU,QAAU,EACtBlL,EAAMkL,aAAUD,EAChBZ,EAAUa,QAAUE,OAAOC,sBAAsBP,KAChD,CAACA,IAEJ,MAAO,CACLF,QACAF,YACAlN,WACAqN,SAAUY,EACVD,aACAE,W,YCVEC,GAAwC,SAAAC,GAC5C,IAAQC,EAAcD,EAAdC,KAAMtM,EAAQqM,EAARrM,IACNK,EAASL,EAATK,EAAGC,EAAMN,EAANM,EAEX,OACE,qBAAGiM,UAAU,cAAb,UACE,uBAAMlM,EAAGA,EAAGC,EAAGA,EAAGkM,GAAG,QAAQC,GAAG,SAAhC,SACGH,IAEH,yBAAQI,GAAIrM,EAAGsM,GAAIrM,EAAG7C,EAAE,UASxBmP,GAA4C,SAAAP,GAChD,IAAQ3M,EAAQ2M,EAAR3M,IAEFmN,EAAC,YAAQnN,EAAIb,KAAI,SAAAuB,GAAE,gBAAOA,EAAGC,EAAV,YAAeD,EAAGE,MAAKC,KAAK,OAA9C,MAEP,OAAO,uBAAMgM,UAAU,gBAAgBM,EAAGA,KAG7BC,GAhFe,WAC5B,IACQzJ,EADU0H,IAAMgC,WAAWC,IAA3BC,MACA5J,IAEA5F,EAAY4F,EAAZ5F,EAAGE,EAAS0F,EAAT1F,EAAGE,EAAMwF,EAANxF,EAERyH,EAAK4H,EAAE5H,GAAGjC,GACVkC,EAAK2H,EAAE3H,GAAGlC,GACVwC,EAAKqH,EAAErH,GAAGxC,GACVyC,EAAKoH,EAAEpH,GAAGzC,GACViD,EAAK4G,EAAE5G,GAAGjD,GACVkD,EAAK2G,EAAE3G,GAAGlD,GAEVqD,EAAQwG,EAAExG,MAAMrD,GAChBsD,EAAOuG,EAAEvG,KAAKtD,GACduD,EAAQsG,EAAEtG,MAAMvD,GAChB0D,EAAWmG,EAAEnG,SAAS1D,GACtB4D,EAAQiG,EAAEjG,MAAM5D,GAEtB,OACE,+BAEE,eAAC,GAAD,CAAYiJ,KAAK,IAAItM,IAAKvC,IAC1B,eAAC,GAAD,CAAY6O,KAAK,IAAItM,IAAKrC,IAC1B,eAAC,GAAD,CAAY2O,KAAK,IAAItM,IAAKnC,IAG1B,eAAC,GAAD,CAAc6B,IAAK,CAAC7B,EAAGyH,EAAIC,EAAI9H,KAC/B,eAAC,GAAD,CAAciC,IAAK,CAACjC,EAAGoI,EAAIC,EAAInI,KAC/B,eAAC,GAAD,CAAc+B,IAAK,CAAC/B,EAAG2I,EAAIC,EAAI1I,KAC/B,eAAC,GAAD,CAAYyO,KAAK,KAAKtM,IAAKsF,IAC3B,eAAC,GAAD,CAAYgH,KAAK,KAAKtM,IAAKuF,IAC3B,eAAC,GAAD,CAAY+G,KAAK,KAAKtM,IAAK6F,IAC3B,eAAC,GAAD,CAAYyG,KAAK,KAAKtM,IAAK8F,IAC3B,eAAC,GAAD,CAAYwG,KAAK,KAAKtM,IAAKsG,IAC3B,eAAC,GAAD,CAAYgG,KAAK,KAAKtM,IAAKuG,IAG3B,eAAC,GAAD,CAAc7G,IAAK,CAAC7B,EAAGyH,EAAIoB,EAAOZ,EAAIa,KACtC,eAAC,GAAD,CAAcjH,IAAK,CAACjC,EAAGmJ,EAAOG,EAAUE,KACxC,eAAC,GAAD,CAAYqF,KAAK,QAAQtM,IAAK0G,IAC9B,eAAC,GAAD,CAAY4F,KAAK,OAAOtM,IAAK2G,IAC7B,eAAC,GAAD,CAAY2F,KAAK,QAAQtM,IAAK4G,IAC9B,eAAC,GAAD,CAAY0F,KAAK,WAAWtM,IAAK+G,IACjC,eAAC,GAAD,CAAYuF,KAAK,QAAQtM,IAAKiH,QCJrBkG,GAnCuB,SAAAd,GACpC,MAA4BtB,IAAMgC,WAAWC,IAArCC,EAAR,EAAQA,MAAOG,EAAf,EAAeA,SACTC,EAAMtC,IAAMC,OAAoB,OCTjC,SACLqC,EACAC,GAEA,MAAwBvC,IAAMG,SAAS,CAAEhI,MAAO,EAAGC,OAAQ,IAA3D,mBAAOF,EAAP,KAAasK,EAAb,KAEAxC,IAAMgB,WAAU,WACd,SAASyB,IACP,GAAIH,EAAI1B,QAAS,CACf,MAA0B0B,EAAI1B,QAAQ8B,wBAChCxK,EAAO,CAAEC,MADf,EAAQA,MACcC,OADtB,EAAeA,QAGf,OADAmK,EAASrK,GACFsK,EAAQtK,IAOnB,OAHAuK,IAEA3B,OAAO6B,iBAAiB,SAAUF,GAC3B,kBAAM3B,OAAO8B,oBAAoB,SAAUH,MACjD,CAACH,EAAKC,IDNTM,CAAQP,EAJiBtC,IAAMS,aAC7B,SAACvI,GAAD,OAAgBmK,EAASS,EAAElJ,WAAW1B,MACtC,CAACmK,KAIH,IAAMnK,EAAO6K,EAAE7K,KAAKgK,GACdc,EAAU9K,EAAKC,MAAQ,EACvB8K,EAAU/K,EAAKE,OAAS,GElBzB,SACLkK,EACAjQ,GAEA,MAA4B2N,IAAMG,SAAS,CAAE+C,KAAM,EAAGC,IAAK,IAA3D,mBAAOC,EAAP,KAAeC,EAAf,KAEQC,EAAiBjR,EAAjBiR,OAAQC,EAASlR,EAATkR,KAEhBvD,IAAMgB,WAAU,WACd,SAASwC,IACP,GAAIlB,EAAI1B,QAAS,CACf,MAAsB0B,EAAI1B,QAAQ8B,wBAA1BQ,EAAR,EAAQA,KAAMC,EAAd,EAAcA,IACd,OAAOE,EAAU,CAAEH,OAAMC,SAO7B,OAHAK,IAEA1C,OAAO6B,iBAAiB,SAAUa,GAC3B,kBAAM1C,OAAO8B,oBAAoB,SAAUY,MACjD,CAAClB,IAEJtC,IAAMgB,WAAU,WACd,SAASyC,EAAWC,GAClB,IAAQR,EAAcE,EAAdF,KAAMC,EAAQC,EAARD,IACNQ,EAAqBD,EAArBC,QAASC,EAAYF,EAAZE,QACjB,OAAON,EAAO,IAAI1M,EAAI+M,EAAUT,EAAMU,EAAUT,IAIlD,OADAU,SAASlB,iBAAiB,YAAac,GAChC,kBAAMI,SAASjB,oBAAoB,YAAaa,MACtD,CAACH,EAAQF,IAEZpD,IAAMgB,WAAU,WACd,SAAS8C,IACP,OAAOP,IAIT,OADAM,SAASlB,iBAAiB,UAAWmB,GAC9B,kBAAMD,SAASjB,oBAAoB,UAAWkB,MACpD,CAACP,IFpBJQ,CAASzB,EAAK,CACZgB,OAAQ,SAAArO,GAAG,OACToN,EAASS,EAAE3J,UAAU,IAAIvC,EAAI3B,EAAIK,EAAI0N,EAAS/N,EAAIM,EAAI0N,MACxDM,KAAM,kBAAMlB,EAASS,EAAExJ,cAGzB,IAAM0K,EAAW,oBAAgBhB,EAAhB,YAA2BC,EAA3B,KAEjB,OACE,sBACEgB,GAAG,SACHC,MAAM,6BACN5B,IAAKA,EAHP,SAKE,qBAAG6B,UAAS,UAAKH,GAAjB,UACG1C,EAAM8C,SACN9C,EAAM+C,OAAS,eAAC,GAAD,UGKTC,GAjC2B,SAAAhD,GACxC,IAAQhB,EAA8DgB,EAA9DhB,MAAOF,EAAuDkB,EAAvDlB,UAAWlN,EAA4CoO,EAA5CpO,SAAUgO,EAAkCI,EAAlCJ,WAAYX,EAAsBe,EAAtBf,SAAUa,EAAYE,EAAZF,QAc1D,IAAMmD,EACJjE,GAASpN,EAAW,UAAYkN,EAAY,QAAU,OAExD,OACE,uBAAK6D,GAAG,WAAR,UACE,yBAAQO,QAbZ,WACE,OAAIlE,GAASpN,EACJkO,IAEAF,KASP,SAA+BqD,IAE/B,wBACErS,KAAK,QACLuS,IAAK,EACLrQ,IAAKlB,EACLG,MAAOiN,EACPiC,SAxBN,SAAsBmB,GACpB,OAAOnD,EAASmE,OAAOhB,EAAEiB,OAAOtR,eC4CrBuR,GAhDqC,SAAAtD,GAClD,MAA4BtB,IAAMgC,WAAWC,IAArCC,EAAR,EAAQA,MAAOG,EAAf,EAAeA,SACf,EAAqDf,EAA7CuD,gBAAR,MAAmB,EAAnB,IAAqDvD,EAA/BwD,gBAAtB,MAAiC,EAAjC,IAAqDxD,EAAjByD,gBAApC,MAA+C,EAA/C,EAEA,EAAoB7C,EAAM5J,IAAlB5F,EAAR,EAAQA,EAAGE,EAAX,EAAWA,EAAGE,EAAd,EAAcA,EAcd,OACE,+BACE,yBACE0O,UAAU,gBACVG,GAAIjP,EAAE4C,EACNsM,GAAIlP,EAAE6C,EACN7C,EAhC4B,EAiC5BsS,YAAaH,EACbI,YApBN,WACE,OAAO5C,EAASS,EAAEjK,uBAqBhB,yBACE2I,UAAU,gBACVG,GAAI/O,EAAE0C,EACNsM,GAAIhP,EAAE2C,EACN7C,EAxC4B,EAyC5BsS,YAAaF,EACbG,YAxBN,WACE,OAAO5C,EAASS,EAAE/J,uBAyBhB,yBACEyI,UAAU,gBACVG,GAAI7O,EAAEwC,EACNsM,GAAI9O,EAAEyC,EACN7C,EAhD4B,EAiD5BsS,YAAaD,EACbE,YA5BN,WACE,OAAO5C,EAASS,EAAE7J,2BCCPiM,GAlBmC,SAAA5D,GAChD,IACA,EADkBtB,IAAMgC,WAAWC,IAA3BC,MACkB5J,IAAlB5F,EAAR,EAAQA,EAAGE,EAAX,EAAWA,EAAGE,EAAd,EAAcA,EAERqS,EAAQ,YAAQzS,EAAE4C,EAAV,YAAe5C,EAAE6C,EAAjB,cAAwB3C,EAAE0C,EAA1B,YAA+B1C,EAAE2C,EAAjC,cAAwCzC,EAAEwC,EAA1C,YAA+CxC,EAAEyC,EAAjD,MAEd,EAAyD+L,EAAjDQ,SAAR,MAAYqD,EAAZ,IAAyD7D,EAAnC8D,eAAtB,MAAgC,EAAhC,IAAyD9D,EAAtB+D,qBAAnC,MAAmD,EAAnD,EAEA,OACE,uBACE7D,UAAU,gBACVM,EAAGA,EACHkD,YAAaI,EACbC,cAAeA,KCQN5P,GApBiC,SAAA6L,GAC9C,IAAQQ,EAAqCR,EAArCQ,EAAGwD,EAAkChE,EAAlCgE,MAAOC,EAA2BjE,EAA3BiE,SAAUC,EAAiBlE,EAAjBkE,aAE5B,OACE,+BACE,uBAAMhE,UAAU,mBAAmBM,EAAGA,IACtC,uBACEN,UAAU,oBACVlM,EAAGiQ,EAASjQ,EACZC,EAAGgQ,EAAShQ,EACZyP,YAAaQ,EACbC,WAAW,SACXC,iBAAiB,SANnB,SAQGJ,QCoKT,ICxKeK,GAVyB,SAAArE,GACtC,MAA6CA,EAArC3M,WAAR,MAAc,GAAd,EAAkB6M,EAA2BF,EAA3BE,UAAlB,EAA6CF,EAAhB8D,eAA7B,MAAuC,EAAvC,EAEMtD,EAAIR,EAAMQ,EACZR,EAAMQ,EADA,YAEDnN,EAAIb,KAAI,SAAAuB,GAAE,gBAAOA,EAAGC,EAAV,YAAeD,EAAGE,MAAKC,KAAK,OAFrC,MAIV,OAAO,uBAAMgM,UAAWA,EAAWM,EAAGA,EAAGkD,YAAaI,KCoFlDQ,GAA0C,SAAAtE,GAC9C,IAAQuE,EAAuBvE,EAAvBuE,KAAM5Q,EAAiBqM,EAAjBrM,IAAKmQ,EAAY9D,EAAZ8D,QAEnB,OACE,wBACE5D,UAAU,oBACVlM,EAAGL,EAAIK,EACPC,EAAGN,EAAIM,EACPyP,YAAaI,EACbK,WAAW,SACXC,iBAAiB,SANnB,UAQGG,EACD,wBAAOrE,UAAU,6BAA6BE,GAAG,OAAjD,mBCwBN,ICrHeoE,GATmC,SAAAxE,GAChD,IAAQyE,EAAiCzE,EAAjCyE,KAAR,EAAyCzE,EAA3B8D,eAAd,MAAwB,EAAxB,EAA2B5D,EAAcF,EAAdE,UAErB7M,EAAM2M,EAAM3M,IAAIb,KAAI,SAAAuB,GAAE,OAAIA,EAAG2Q,OAAOD,EAAK3O,OAAO7C,KAAKwR,EAAKvO,QAC1DsK,EAAC,YAAQnN,EAAIb,KAAI,SAAAuB,GAAE,gBAAOA,EAAGC,EAAV,YAAeD,EAAGE,MAAKC,KAAK,OAA9C,MAEP,OAAO,uBAAMgM,UAAWA,EAAWM,EAAGA,EAAGkD,YAAaI,KC8GxD,ICpHaa,GAAgB,CNgLhB,CACXC,QAlLwB,WACxB,OACE,qCACE,uDAEA,iDACiB,sDADjB,8TAMa,sCANb,2CAMoE,IAClE,sCAPF,QAOqB,sCAPrB,wCAOyE,IACvE,sCACG,qCADH,OACmB,qCADnB,OACmC,wCATrC,OAaA,4CACY,uCADZ,8UAOA,gEACgC,wCADhC,mUASA,oIAE2B,uBAAM1E,UAAU,wBAF3C,sHAiJJ2E,SAvIyB,WACzB,IAAQjE,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEFkE,EAAgBpG,IAAMqG,SAC1B,kBAAwBnE,EAAM5J,IA6DzBtF,EAAKsT,KAAK,CACfvB,SAAU/R,EAAKuT,KAAK,EAAG,EAAG,KAC1B1B,SAAU7R,EAAKwT,KAAK,EAAG,KAAKC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACjDzB,SAAU9R,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,UA/DlD,CAACrE,EAAM5J,MAEHoO,EAAW1G,IAAMqG,SAAQ,kBAuEjC,SAAsB/N,GACpB,IAAQ5F,EAAY4F,EAAZ5F,EAAGE,EAAS0F,EAAT1F,EAAGE,EAAMwF,EAANxF,EAEd,OAAOE,EAAKsT,KAAK,CACfxE,EAAG6E,EAAWjS,QAAQ,CAAC5B,EAAGJ,EAAGE,GAAI,MACjCwS,QAASpS,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,QA5EdK,CAAa1E,EAAM5J,OAAM,CAAC4J,EAAM5J,MAC/DuO,EAAe7G,IAAMqG,SACzB,kBAmFsB/N,EAnFC4J,EAAM5J,IAoFxBtF,EAAKsT,KAAK,CACfQ,GAAI9T,EAAKwT,KAAK,GAAI,KAAMC,KACtBE,EAAWlR,YACT0M,GAAoB7J,GACpB6J,GAAkB7J,GAClB,GACA,OAGJyO,SAAU/T,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MAClDS,GAAIhU,EAAKwT,KAAK,GAAI,KAAMC,KACtBE,EAAWlR,YACT0M,GAAoB7J,GACpB6J,GAAkB7J,GAClB,GACA,OAGJ2O,SAAUjU,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MAClDW,GAAIlU,EAAKwT,KAAK,GAAI,KAAMC,KACtBE,EAAWlR,YACT0M,GAAoB7J,GACpB6J,GAAkB7J,GAClB,GACA,OAGJ6O,SAAUnU,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,QA5BtD,IAA0BjO,IAlFtB,CAAC4J,EAAM5J,MAQH8O,EAAetH,GALC3L,KAAKC,IACzBgS,EAAclT,SACdwT,EAASxT,SACT2T,EAAa3T,WAGPoN,EAAU8G,EAAV9G,MAER,EAAyC8F,EAAcnT,GAAGqN,GAAlDuE,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,SAAUC,EAA5B,EAA4BA,SAC5B,EAAuB2B,EAASzT,GAAGqN,GAA3BwB,EAAR,EAAQA,EAAGsD,EAAX,EAAWA,QACX,EAAqDyB,EAAa5T,GAAGqN,GAA7DwG,EAAR,EAAQA,GAAIC,EAAZ,EAAYA,SAAUC,EAAtB,EAAsBA,GAAIC,EAA1B,EAA0BA,SAAUC,EAApC,EAAoCA,GAAIC,EAAxC,EAAwCA,SAElCE,EAAYlF,GAAoBD,EAAM5J,KACtCgP,EAAYnF,GAAoBD,EAAM5J,KACtCiP,EAAYpF,GAAoBD,EAAM5J,KAE5C,OACE,uCACE,gBAAC,GAAD,WACE,eAAC,GAAD,CACEwJ,EAAGgF,EACHxB,MAAM,IACNC,SAAU8B,EACV7B,aAAcuB,IAEhB,eAAC,GAAD,CACEjF,EAAGkF,EACH1B,MAAM,IACNC,SAAU+B,EACV9B,aAAcyB,IAEhB,eAAC,GAAD,CACEnF,EAAGoF,EACH5B,MAAM,IACNC,SAAUgC,EACV/B,aAAc2B,IAGhB,eAAC,GAAD,CAAcrF,EAAGA,EAAGsD,QAASA,IAC7B,eAAC,GAAD,CACEP,SAAUA,EACVC,SAAUA,EACVC,SAAUA,OAId,eAAC,GAAD,eAAcqC,SEyCP,CACXlB,QAjJwB,WACxB,IAAQ7D,EAAarC,IAAMgC,WAAWC,IAA9BI,SAUR,OACE,qCACE,4DAEA,6EAC8C,IAC5C,sCACG,qCADH,OACmB,qCADnB,OACmC,wCAC3B,IAJV,+IAMsE,IACpE,sCAPF,kBAOgC,IAC9B,sCACG,wCATL,uJAgBA,sFAEA,2FAC4D,IAC1D,yBAAQmC,QAhCd,WACE,OAAOnC,EAASS,EAAEtJ,aA+Bd,qBAFF,QAEqD,IACnD,kDAHF,sCAGkE,IAChE,kDAJF,4CAIwE,IACtE,kDALF,uNAQ2B,IACzB,yBAAQgL,QAnCd,WACE,OAAOnC,EAASS,EAAEpJ,aAkCd,0BATF,4HAiHJyM,SAhGyB,WACzB,IAAQjE,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEFsF,EAAUxH,IAAMqG,SAAQ,kBAyDX/N,EAzD6B4J,EAAM5J,IA0D/CtF,EAAKsT,KAAK,CACfQ,GAAIH,EAAWjS,QAAQyN,EAAU7J,GAAM,MACvCyO,SAAU/T,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MAClDS,GAAIL,EAAWjS,QAAQyN,EAAU7J,GAAM,MACvC2O,SAAUjU,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MAClDW,GAAIP,EAAWjS,QAAQyN,GAAU7J,GAAM,MACvC6O,SAAUnU,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,QAPtD,IAAqBjO,IAzDyC,CAAC4J,EAAM5J,MAC7DmP,EAASzH,IAAMqG,SAAQ,kBAAiBnE,EAAM5J,IA6E7CtF,EAAKsT,KAAK,CACfoB,cAAe1U,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACvDoB,cAAe3U,EAAKwT,KAAK,EAAG,KAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACvDqB,cAAe5U,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,UAhFC,CAACrE,EAAM5J,MAG3D8O,EAAetH,GADC3L,KAAKC,IAAIoT,EAAQtU,SAAUuU,EAAOvU,WAEhDoN,EAAU8G,EAAV9G,MAER,EAAqDkH,EAAQvU,GAAGqN,GAAxDwG,EAAR,EAAQA,GAAIC,EAAZ,EAAYA,SAAUC,EAAtB,EAAsBA,GAAIC,EAA1B,EAA0BA,SAAUC,EAApC,EAAoCA,GAAIC,EAAxC,EAAwCA,SACxC,EAAwDM,EAAOxU,GAAGqN,GAA1DoH,EAAR,EAAQA,cAAeC,EAAvB,EAAuBA,cAAeC,EAAtC,EAAsCA,cAEhCP,EAAYlF,EAAeD,EAAM5J,KACjCgP,EAAYnF,GAAeD,EAAM5J,KACjCiP,EAAYpF,GAAeD,EAAM5J,KAEvC,OACE,uCACE,gBAAC,GAAD,WACE,eAAC,GAAD,CAASkJ,UAAU,cAAcM,EAAGgF,EAAI1B,QAAS2B,IACjD,eAAC,GAAD,CAASvF,UAAU,cAAcM,EAAGkF,EAAI5B,QAAS6B,IACjD,eAAC,GAAD,CAASzF,UAAU,cAAcM,EAAGoF,EAAI9B,QAAS+B,IACjD,eAAC,GAAD,CAAatB,KAAK,IAAI5Q,IAAKoS,EAAWjC,QAASsC,IAC/C,eAAC,GAAD,CAAa7B,KAAK,IAAI5Q,IAAKqS,EAAWlC,QAASuC,IAC/C,eAAC,GAAD,CAAa9B,KAAK,IAAI5Q,IAAKsS,EAAWnC,QAASwC,IAC/C,eAAC,GAAD,IACA,eAAC,GAAD,OAEF,eAAC,GAAD,eAAcR,SKfP,CACXlB,QAjEwB,WACxB,OACE,qCACE,0DAEA,mIAE+B,kDAF/B,gEAMA,+MAuDJC,SA9CyB,WACzB,IAAQjE,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEF2F,EAAa7H,IAAMqG,SACvB,kBA0BoB/N,EA1BC4J,EAAM5J,IA2BtBtF,EAAKsT,KAAK,CACfwB,OAAQnB,EAAWjS,QAAQyN,GAAc7J,GAAM,MAC/CyP,MAAO/U,EAAKwT,KAAK,GAAI,MAAMC,KACzBE,EAAWjS,QAAQyN,GAAa7J,GAAM,SAJ5C,IAAwBA,IAzBpB,CAAC4J,EAAM5J,MAGH8O,EAAetH,GAAkB+H,EAAW3U,UAC1CoN,EAAU8G,EAAV9G,MAER,EAA0BuH,EAAW5U,GAAGqN,GAAhCwH,EAAR,EAAQA,OAAQC,EAAhB,EAAgBA,MAEhB,OACE,uCACE,gBAAC,GAAD,WACE,eAAC,GAAD,CAASvG,UAAU,cAAc7M,IAAKwN,EAAUD,EAAM5J,OACtD,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,EAAUD,EAAM5J,OACtD,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,GAAUD,EAAM5J,OACtD,eAAC,GAAD,IACA,eAAC,GAAD,CAASkJ,UAAU,aAAaM,EAAGgG,IACnC,eAAC,GAAD,CAAStG,UAAU,aAAaM,EAAGiG,IACnC,eAAC,GAAD,OAGF,eAAC,GAAD,eAAcX,SJkFP,CACXlB,QA/HwB,WACxB,OACE,qCACE,sDAEA,gKAE0D,IACxD,0CAHF,mBAGqC,IACnC,4CACS,wCALX,WA2HJC,SA9GyB,WACzB,IAAQjE,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEF2E,EAAe7G,IAAMqG,SACzB,kBAwDsB/N,EAxDC4J,EAAM5J,IAyDxBtF,EAAKsT,KAAK,CACf0B,IAAKrB,EAAWlR,YACd0M,GAA2B7J,GAC3B6J,GAAyB7J,GACzB,GACA,MAEF2P,UAAWjV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACnD2B,IAAKlV,EAAKwT,KAAK,GAAI,KAAMC,KACvBE,EAAWlR,YACT0M,GAA2B7J,GAC3B6J,GAAyB7J,GACzB,GACA,OAGJ6P,UAAWnV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACnD6B,IAAKzB,EAAWlR,YACd0M,GAA2B7J,GAC3B6J,GAAyB7J,GACzB,GACA,MAEF+P,UAAWrV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACnD+B,IAAKtV,EAAKwT,KAAK,GAAI,KAAMC,KACvBE,EAAWlR,YACT0M,GAA2B7J,GAC3B6J,GAAyB7J,GACzB,GACA,OAGJiQ,UAAWvV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,QAjCvD,IAA0BjO,IAvDtB,CAAC4J,EAAM5J,MAGH8O,EAAetH,GAAkB+G,EAAa3T,UAC5CoN,EAAU8G,EAAV9G,MAER,EACEuG,EAAa5T,GAAGqN,GADV0H,EAAR,EAAQA,IAAKC,EAAb,EAAaA,UAAWC,EAAxB,EAAwBA,IAAKC,EAA7B,EAA6BA,UAAWC,EAAxC,EAAwCA,IAAKC,EAA7C,EAA6CA,UAAWC,EAAxD,EAAwDA,IAAKC,EAA7D,EAA6DA,UAEvDC,EAAarG,GAA2BD,EAAM5J,KAC9CmQ,EAAatG,GAA2BD,EAAM5J,KAC9CoQ,EAAavG,GAA2BD,EAAM5J,KAC9CqQ,EAAaxG,GAA2BD,EAAM5J,KAEpD,OACE,uCACE,gBAAC,GAAD,WACE,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,EAAUD,EAAM5J,OACtD,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,EAAUD,EAAM5J,OACtD,eAAC,GAAD,CAASkJ,UAAU,kBAAkB7M,IAAKwN,GAAUD,EAAM5J,OAC1D,eAAC,GAAD,IACA,eAAC,GAAD,CAASkJ,UAAU,aAAa7M,IAAKwN,GAAcD,EAAM5J,OAEzD,eAAC,GAAD,CACEwJ,EAAGkG,EACH1C,MAAM,IACNC,SAAUiD,EACVhD,aAAcyC,IAEhB,eAAC,GAAD,CACEnG,EAAGoG,EACH5C,MAAM,IACNC,SAAUkD,EACVjD,aAAc2C,IAEhB,eAAC,GAAD,CACErG,EAAGsG,EACH9C,MAAM,IACNC,SAAUmD,EACVlD,aAAc6C,IAEhB,eAAC,GAAD,CACEvG,EAAGwG,EACHhD,MAAM,IACNC,SAAUoD,EACVnD,aAAc+C,IAGhB,eAAC,GAAD,OAGF,eAAC,GAAD,eAAcnB,SK4HP,CACXlB,QArMwB,WACxB,OACE,qCACE,sDAEA,0PAIoB,0CAJpB,6BAIiE,IAC/D,4CACS,wCACD,IAPV,cAWA,gMAsLJC,SA7KyB,WACzB,IAAQjE,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEF0G,EAAY5I,IAAMqG,SAAQ,kBAuFlC,SAAuB/N,GACrB,IAAMuQ,EAAW1G,GAAc7J,GACzBwQ,EAAY3G,GAAgB7J,GAC5ByQ,EAAY5G,GAAgB7J,GAC5B0Q,EAAY7G,GAAgB7J,GAElC,OAAOtF,EAAKsT,KAAK,CACf2C,SAAUjW,EAAKuT,KAAKsC,EAAUC,EAAW,MACzCI,YAAalW,EAAKuT,KAAK,EAAG,EAAG,KAC7B4C,SAAUnW,EAAKwT,KAAKsC,EAAW,MAAMrC,KACnCzT,EAAKuT,KAAKuC,EAAWC,EAAW,OAElCK,YAAapW,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACrD8C,SAAUrW,EAAKwT,KAAKuC,EAAW,MAAMtC,KACnCzT,EAAKuT,KAAKwC,EAAWC,EAAW,OAElCM,YAAatW,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,QAvGjBgD,CAAcrH,EAAM5J,OAAM,CAAC4J,EAAM5J,MACjEuO,EAAe7G,IAAMqG,SACzB,kBAkHsB/N,EAlHC4J,EAAM5J,IAmHxBtF,EAAKsT,KAAK,CACf0B,IAAKhV,EAAKwT,KAAK,GAAI,MAAMC,KACvBE,EAAWlR,YACT0M,GAA4B7J,GAC5B6J,GAA0B7J,GAC1B,GACA,OAGJ2P,UAAWjV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACnD2B,IAAKlV,EAAKwT,KAAK,GAAI,MAAMC,KACvBE,EAAWlR,YACT0M,GAA4B7J,GAC5B6J,GAA0B7J,GAC1B,GACA,OAGJ6P,UAAWnV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACnD6B,IAAKpV,EAAKwT,KAAK,GAAI,MAAMC,KACvBE,EAAWlR,YACT0M,GAA4B7J,GAC5B6J,GAA0B7J,GAC1B,GACA,OAGJ+P,UAAWrV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACnD+B,IAAKtV,EAAKwT,KAAK,GAAI,MAAMC,KACvBE,EAAWlR,YACT0M,GAA4B7J,GAC5B6J,GAA0B7J,GAC1B,GACA,OAGJiQ,UAAWvV,EAAKwT,KAAK,EAAG,MAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,QArCvD,IAA0BjO,IAjHtB,CAAC4J,EAAM5J,MAGH8O,EAAetH,GAAkB+G,EAAa3T,UAC5CoN,EAAU8G,EAAV9G,MAER,EAOIsI,EAAU3V,GAAGqN,GANf2I,EADF,EACEA,SACAC,EAFF,EAEEA,YACAC,EAHF,EAGEA,SACAC,EAJF,EAIEA,YACAC,EALF,EAKEA,SACAC,EANF,EAMEA,YAEIE,EAASrH,GAAaD,EAAM5J,KAElC,EACEuO,EAAa5T,GAAGqN,GADV0H,EAAR,EAAQA,IAAKC,EAAb,EAAaA,UAAWC,EAAxB,EAAwBA,IAAKC,EAA7B,EAA6BA,UAAWC,EAAxC,EAAwCA,IAAKC,EAA7C,EAA6CA,UAAWC,EAAxD,EAAwDA,IAAKC,EAA7D,EAA6DA,UAEvDC,EAAarG,GAA4BD,EAAM5J,KAC/CmQ,EAAatG,GAA4BD,EAAM5J,KAC/CoQ,EAAavG,GAA4BD,EAAM5J,KAC/CqQ,EAAaxG,GAA4BD,EAAM5J,KAErD,OACE,uCACE,gBAAC,GAAD,WACE,eAAC,GAAD,CAASkJ,UAAU,kBAAkB7M,IAAKwN,EAAUD,EAAM5J,OAC1D,eAAC,GAAD,CAASkJ,UAAU,kBAAkB7M,IAAKwN,EAAUD,EAAM5J,OAC1D,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,GAAUD,EAAM5J,OACtD,eAAC,GAAD,IAEA,eAAC,GAAD,CACEkJ,UAAU,qBACV7M,IAAK6U,EACLzD,KAAMkD,EACN7D,QAAS8D,IAEX,eAAC,GAAD,CACE1H,UAAU,qBACV7M,IAAK6U,EACLzD,KAAMoD,EACN/D,QAASgE,IAEX,eAAC,GAAD,CACE5H,UAAU,qBACV7M,IAAK6U,EACLzD,KAAMsD,EACNjE,QAASkE,IAGX,eAAC,GAAD,CACExH,EAAGkG,EACH1C,MAAM,IACNC,SAAUiD,EACVhD,aAAcyC,IAEhB,eAAC,GAAD,CACEnG,EAAGoG,EACH5C,MAAM,IACNC,SAAUkD,EACVjD,aAAc2C,IAEhB,eAAC,GAAD,CACErG,EAAGsG,EACH9C,MAAM,IACNC,SAAUmD,EACVlD,aAAc6C,IAEhB,eAAC,GAAD,CACEvG,EAAGwG,EACHhD,MAAM,IACNC,SAAUoD,EACVnD,aAAc+C,IAGhB,eAAC,GAAD,CAAS/G,UAAU,aAAa7M,IAAKwN,GAAaD,EAAM5J,OACxD,eAAC,GAAD,OAGF,eAAC,GAAD,eAAc8O,SC/BP,CACXlB,QAjFwB,WACxB,OACE,qCACE,gEAEA,8JAEsD,IACpD,sCACG,wCAJL,uBAOE,yCAPF,uEAQiB,IACf,sCACG,wCAVL,WA6EJC,SA3DyB,WACzB,IAAQjE,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEFkD,EAAUpF,IAAMqG,SAAQ,kBAAkBnE,EAAM5J,IA6C/CtF,EAAKsT,KAAK,CACfmD,WAAYzW,EAAKuT,KAAK,EAAG,EAAG,UA9C8B,CAACrE,EAAM5J,MAE7D8O,EAAetH,GAAkBsF,EAAQlS,UACvCoN,EAAU8G,EAAV9G,MAEAmJ,EAAerE,EAAQnS,GAAGqN,GAA1BmJ,WACFD,EAASrH,GAAaD,EAAM5J,KAElC,OACE,uCACE,gBAAC,GAAD,WACE,eAAC,GAAD,CAASkJ,UAAU,kBAAkB7M,IAAKwN,EAAUD,EAAM5J,OAC1D,eAAC,GAAD,CAASkJ,UAAU,kBAAkB7M,IAAKwN,EAAUD,EAAM5J,OAC1D,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,GAAUD,EAAM5J,OAEtD,eAAC,GAAD,CAAc8M,QAASqE,EAAYpE,cAAeoE,IAClD,eAAC,GAAD,CACEjI,UAAU,qBACV7M,IAAK6U,EACLzD,KAAM5D,GAAgBD,EAAM5J,KAC5B8M,QAASqE,IAEX,eAAC,GAAD,CACEjI,UAAU,qBACV7M,IAAK6U,EACLzD,KAAM5D,GAAgBD,EAAM5J,KAC5B8M,QAASqE,IAEX,eAAC,GAAD,CACEjI,UAAU,qBACV7M,IAAK6U,EACLzD,KAAM5D,GAAgBD,EAAM5J,KAC5B8M,QAASqE,IAGX,eAAC,GAAD,CAASjI,UAAU,aAAa7M,IAAKwN,GAAaD,EAAM5J,OACxD,eAAC,GAAD,OAGF,eAAC,GAAD,eAAc8O,SJmDP,CACXlB,QArHwB,WACxB,OACE,qCACE,gEAEA,iEACiC,uCADjC,yHAGqB,IACnB,sCACG,wCACK,IANV,MAOM,IACJ,sCACG,wCATL,aAiHJC,SAhGyB,WACzB,IAAQjE,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEF0G,EAAY5I,IAAMqG,SAAQ,kBAoDlC,SAAuB/N,GACrB,IAAMuQ,EAAW1G,GAAc7J,GACzBwQ,EAAY3G,GAAiB7J,GAC7ByQ,EAAY5G,GAAiB7J,GAC7B0Q,EAAY7G,GAAiB7J,GAEnC,OAAOtF,EAAKsT,KAAK,CACf2C,SAAUjW,EAAKuT,KAAKsC,EAAUC,EAAW,MACzCI,YAAalW,EAAKuT,KAAK,EAAG,EAAG,KAC1BE,KAAKzT,EAAKwT,KAAK,EAAG,OAClBC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,OACxB4C,SAAUnW,EAAKwT,KAAKsC,EAAW,MAAMrC,KACnCzT,EAAKuT,KAAKuC,EAAWC,EAAW,OAElCK,YAAapW,EAAKwT,KAAK,EAAG,MACvBC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACrBE,KAAKzT,EAAKwT,KAAK,EAAG,OAClBC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,OACxB8C,SAAUrW,EAAKwT,KAAKuC,EAAW,MAAMtC,KACnCzT,EAAKuT,KAAKwC,EAAWC,EAAW,OAElCM,YAAatW,EAAKwT,KAAK,EAAG,MACvBC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,MACrBE,KAAKzT,EAAKwT,KAAK,EAAG,MAClBC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,OACxBmD,eAAgB1W,EAAKwT,KAAK,EAAG,KAAMC,KAAKzT,EAAKuT,KAAK,EAAG,EAAG,SA7EpBgD,CAAcrH,EAAM5J,OAAM,CAAC4J,EAAM5J,MAEjE8O,EAAetH,GAAkB8I,EAAU1V,UACzCoN,EAAU8G,EAAV9G,MAER,EAQIsI,EAAU3V,GAAGqN,GAPf2I,EADF,EACEA,SACAC,EAFF,EAEEA,YACAC,EAHF,EAGEA,SACAC,EAJF,EAIEA,YACAC,EALF,EAKEA,SACAC,EANF,EAMEA,YACAI,EAPF,EAOEA,eAEIF,EAASrH,GAAaD,EAAM5J,KAElC,OACE,uCACE,gBAAC,GAAD,WACE,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,EAAUD,EAAM5J,OACtD,eAAC,GAAD,CAASkJ,UAAU,cAAc7M,IAAKwN,EAAUD,EAAM5J,OACtD,eAAC,GAAD,CAASkJ,UAAU,kBAAkB7M,IAAKwN,GAAUD,EAAM5J,OAE1D,eAAC,GAAD,CAAc8M,QAASsE,EAAgBrE,cAAeqE,IACtD,eAAC,GAAD,CACElI,UAAU,qBACV7M,IAAK6U,EACLzD,KAAMkD,EACN7D,QAAS8D,IAEX,eAAC,GAAD,CACE1H,UAAU,qBACV7M,IAAK6U,EACLzD,KAAMoD,EACN/D,QAASgE,IAEX,eAAC,GAAD,CACE5H,UAAU,qBACV7M,IAAK6U,EACLzD,KAAMsD,EACNjE,QAASkE,IAGX,eAAC,GAAD,CAAS9H,UAAU,aAAa7M,IAAKwN,GAAcD,EAAM5J,OACzD,eAAC,GAAD,OAGF,eAAC,GAAD,eAAc8O,SKpDP,CACXlB,QA/BwB,WACxB,OACE,qCACE,0DAEA,2FAC4D,IAC1D,sCACG,qCADH,OACmB,qCADnB,WAEQ,IAJV,UAKS,sCALT,sFAMoC,IAClC,sCACG,qCADH,WAPF,uCAUsC,gDAVtC,wCAWyB,IACvB,sCACG,qCADH,OACmB,qCADnB,YACwC,qCADxC,WAZF,WA2BJC,SANyB,WACzB,OAAO,OCbI,CACXD,QAfwB,WACxB,OACE,qCACE,6DAEA,2BAWJC,SANyB,WACzB,OAAO,QCPF,SAASwD,GAAQzH,EAAc0H,GACpC,OAAQA,EAAO1X,MACb,KAAK4F,EAAWY,aACd,OA0BN,SAA4BwJ,GAC1B,OAAO,2BAAKA,GAAZ,IAAmB1J,UAAWrE,KAAKC,IAAI,EAAG8N,EAAM1J,UAAY,KA3BjDqR,CAAmB3H,GAC5B,KAAKpK,EAAWc,SACd,OA4BN,SAAwBsJ,GACtB,OAAO,2BACFA,GADL,IAEE1J,UAAWrE,KAAKsQ,IAAIwB,GAAMnR,OAAS,EAAGoN,EAAM1J,UAAY,KA/B/CsR,CAAe5H,GACxB,KAAKpK,EAAWgB,iBACd,OAiCN,SAAgCoJ,GAC9B,MAAoBA,EAAM5J,IAAlB5F,EAAR,EAAQA,EAAGE,EAAX,EAAWA,EAAGE,EAAd,EAAcA,EACRX,EAAUS,EAAE0C,EAAI5C,EAAE4C,EAClBlD,EAAUU,EAAEyC,EAAI7C,EAAE6C,EAExB,OAAO,2BAAK2M,GAAZ,IAAmB3J,YAAatG,EAAYQ,QAAQN,EAASC,KAtClD2X,CAAuB7H,GAChC,KAAKpK,EAAWkB,iBACd,OAuCN,SAAgCkJ,GAC9B,OAAO,2BAAKA,GAAZ,IAAmB3J,YAAatG,EAAYU,YAxCjCqX,CAAuB9H,GAChC,KAAKpK,EAAWoB,iBACd,OAyCN,SAAgCgJ,GAC9B,OAAO,2BAAKA,GAAZ,IAAmB3J,YAAatG,EAAYY,YA1CjCoX,CAAuB/H,GAChC,KAAKpK,EAAWsB,UACd,OA2CN,SAAyB8I,EAAcgI,GACrC,OAAOhI,EAAM3J,YAAY4R,MAAM,CAC7B3X,KAAM,kBAAM0P,GACZxP,EAAG,SAACP,EAASC,GAAV,OAMP,SACE8P,EACA/P,EACAC,EACA8X,GAEA,IAAMtX,EAAI,IAAIgE,EAAIsT,EAAS5U,EAAInD,EAAS+X,EAAS3U,GAC3CzC,EAAI,IAAI8D,EAAIsT,EAAS5U,EAAG4U,EAAS3U,EAAInD,GAC3C,OAAO,2BAAK8P,GAAZ,IAAmB5J,IAAK,CAAE5F,EAAGwX,EAAUtX,IAAGE,OAdfsX,CAAYlI,EAAO/P,EAASC,EAAS8X,IAC9DtX,EAAG,kBAkBP,SAAqBsP,EAAcgI,GACjC,MAAiBhI,EAAM5J,IAAf5F,EAAR,EAAQA,EAAGI,EAAX,EAAWA,EAELuX,EACJlW,KAAKmW,IAAIJ,EAAS5U,EAAI5C,EAAE4C,GAAKiV,GACzB7X,EAAE4C,EAAIiV,GAAiB9S,EAAKyS,EAAS5U,EAAI5C,EAAE4C,GAC3C4U,EAAS5U,EACTkV,EACJrW,KAAKmW,IAAIJ,EAAS3U,EAAIzC,EAAEyC,GAAKgV,GACzBzX,EAAEyC,EAAIgV,GAAiB9S,EAAKyS,EAAS3U,EAAIzC,EAAEyC,GAC3C2U,EAAS3U,EAETkV,EAAO,IAAI7T,EAAIyT,EAAIG,GACnBE,EAAO,IAAI9T,EAAIlE,EAAE4C,EAAGkV,GAE1B,OAAO,2BAAKtI,GAAZ,IAAmB5J,IAAI,2BAAM4J,EAAM5J,KAAb,IAAkB5F,EAAGgY,EAAM9X,EAAG6X,MAjCzCE,CAAYzI,EAAOgI,IAC5BpX,EAAG,kBAmCP,SAAqBoP,EAAcgI,GACjC,MAAiBhI,EAAM5J,IAAf5F,EAAR,EAAQA,EAAGE,EAAX,EAAWA,EAELgY,EACJzW,KAAKmW,IAAIJ,EAAS5U,EAAI1C,EAAE0C,GAAKiV,GACzB3X,EAAE0C,EAAIiV,GAAiB9S,EAAKyS,EAAS5U,EAAI1C,EAAE0C,GAC3C4U,EAAS5U,EACTuV,EACJ1W,KAAKmW,IAAIJ,EAAS3U,EAAI7C,EAAE6C,GAAKgV,GACzB7X,EAAE6C,EAAIgV,GAAiB9S,EAAKyS,EAAS3U,EAAI7C,EAAE6C,GAC3C2U,EAAS3U,EAETuV,EAAO,IAAIlU,EAAIgU,EAAIC,GACnBH,EAAO,IAAI9T,EAAIgU,EAAIlY,EAAE6C,GAE3B,OAAO,2BAAK2M,GAAZ,IAAmB5J,IAAI,2BAAM4J,EAAM5J,KAAb,IAAkB5F,EAAGgY,EAAM5X,EAAGgY,MAlDzCC,CAAY7I,EAAOgI,MAhDnBc,CAAgB9I,EAAO0H,EAAOvQ,SACvC,KAAKvB,EAAWyB,QACd,OAmGN,SAAuB2I,GACrB,IAAM7J,EAAiB4S,GAAiB/I,EAAOA,EAAMjK,GAAGC,MACxD,OAAO,2BACFgK,GADL,IAEEjK,GAAG,2BAAMiK,EAAMjK,IAAb,IAAiBI,mBACnBE,YAAatG,EAAYM,SAxGhB2Y,CAAchJ,GACvB,KAAKpK,EAAW2B,SACd,OA0GN,SAAwByI,GACtB,IAAMxP,EAAI,IAAIkE,GAAK,GAAI,GACjBhE,EAAI,IAAIgE,EAAI,GAAIlE,EAAE6C,GAClBzC,EAAI,IAAI8D,EAAIlE,EAAE4C,GAAG,IAEvB,OAAO,2BAAK4M,GAAZ,IAAmB5J,IAAI,2BAAM4J,EAAM5J,KAAb,IAAkB5F,IAAGE,IAAGE,QA/GnCqY,CAAejJ,GACxB,KAAKpK,EAAW6B,SACd,OAgHN,SAAwBuI,GACtB,IAAMxP,EAAI,IAAIkE,EAAI,EAAG,IAEfhE,EAAI,IAAIgE,EAAI,GAAIlE,EAAE6C,GAClBzC,EAAI,IAAI8D,EAAIlE,EAAE4C,GAAI,IAExB,OAAO,2BAAK4M,GAAZ,IAAmB5J,IAAI,2BAAM4J,EAAM5J,KAAb,IAAkB5F,IAAGE,IAAGE,QAtHnCsY,CAAelJ,GACxB,KAAKpK,EAAW+B,WACd,OAuHN,SAA0BqI,EAAchK,GACtC,IAAMG,EAAiB4S,GAAiB/I,EAAOhK,GAC/C,OAAO,2BAAKgK,GAAZ,IAAmBjK,GAAG,2BAAMiK,EAAMjK,IAAb,IAAiBC,OAAMG,qBAzHjCgT,CAAiBnJ,EAAO0H,EAAOvQ,SACxC,KAAKvB,EAAWiC,kBACd,OA0HN,SAAiCmI,GAC/B,OAAO,2BAAKA,GAAZ,IAAmB5J,IAAKP,EAASE,GAAG,2BAAMiK,EAAMjK,IAAb,IAAiBI,gBAAgB,MA3HzDiT,CAAwBpJ,GACjC,QACE,OAAOA,GAmDb,IAAMqI,GAAiB,GAyEvB,SAASU,GAAiB/I,EAAchK,GACtC,IAAQxF,EAAMwP,EAAM5J,IAAZ5F,EACAyF,EAAkBD,EAAlBC,MAAOC,EAAWF,EAAXE,OAETmT,EAAOpX,KAAKmW,IAAI5X,EAAE4C,GAAK6C,EAAQ,EAC/BqT,EAAOrX,KAAKmW,IAAI5X,EAAE6C,GAAK6C,EAAS,EACtC,OAAOmT,GAAQC,EC9JV,SAASC,GAAcvJ,GAC5B,OAAOA,EAAM1J,UAAY,EAGpB,SAASkT,GAAUxJ,GACxB,OAAOA,EAAM1J,UAAYyN,GAAMnR,OAAS,EAGnC,SAAS6W,GAAazJ,GAC3B,MAAM,GAAN,OAAUA,EAAM1J,UAAY,EAA5B,cAAmCyN,GAAMnR,QAGpC,SAAS8W,GAAe1J,GAC7B,OAAO+D,GAAM/D,EAAM1J,WAAW0N,QAGzB,SAAS2F,GAAgB3J,GAC9B,OAAO+D,GAAM/D,EAAM1J,WAAW2N,SAGzB,SAAS8E,GAAiB/I,GAC/B,OAAOA,EAAMjK,GAAGI,eAGX,SAASH,GAAKgK,GACnB,OAAOA,EAAMjK,GAAGC,KCnBX,IAAM+J,GAAejC,IAAM8L,cAAc,CAC9C5J,MAAOlK,EACPqK,SAAU,OCXG,OAA0B,mCCuB1B0J,GApBU,WACvB,OACE,kCACE,iCACE,oBAAGC,KAAK,4BAA4BrH,OAAO,SAASsH,IAAI,aAAxD,SACE,sBAAKhI,GAAG,OAAOiI,IAAKC,GAAQC,IAAI,sBAGlC,oBACEJ,KAAK,uCACLrH,OAAO,SACPsH,IAAI,aAHN,0BCIOI,GAZS,WACtB,IAAQnK,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEFoK,EAAUvJ,EAAE6I,eAAe1J,GAEjC,OACE,0BAAS+B,GAAG,QAAZ,SACE,eAACqI,EAAD,OCWSC,GAlBqB,WAClC,MAA4BvM,IAAMgC,WAAWC,IAArCC,EAAR,EAAQA,MAAOG,EAAf,EAAeA,SAMf,OAAIU,EAAEkI,iBAAiB/I,GAEnB,sBAAK+B,GAAG,sBAAR,SACE,yBAAQO,QAPd,WACE,OAAOnC,EAASS,EAAEhJ,sBAMd,8BAIG,MCAI0S,GAbgB,WAC7B,IAAQtK,EAAUlC,IAAMgC,WAAWC,IAA3BC,MAEFuK,EAAW1J,EAAE8I,gBAAgB3J,GAEnC,OACE,2BAAS+B,GAAG,eAAZ,UACE,eAACwI,EAAD,IACA,eAAC,GAAD,QCsBSC,GA/BU,WACvB,MAA4B1M,IAAMgC,WAAWC,IAArCC,EAAR,EAAQA,MAAOG,EAAf,EAAeA,SAETsK,GAAc5J,EAAE0I,cAAcvJ,GAC9B0K,GAAU7J,EAAE2I,UAAUxJ,GAU5B,OACE,kCACE,iCACE,yBAAQsC,QAXd,WACE,OAAOnC,EAASS,EAAErK,iBAUmBoU,SAAUF,EAA3C,sBAIA,gCAAO5J,EAAE4I,aAAazJ,KAEtB,yBAAQsC,QAbd,WACE,OAAOnC,EAASS,EAAEnK,aAYekU,SAAUD,EAAvC,wBCJOE,GAfO,WACpB,MAA0B9M,IAAM+M,WAAWpD,GAAS3R,GAApD,mBAAOkK,EAAP,KAAcG,EAAd,KAEA,OACE,gBAACJ,GAAa+K,SAAd,CAAuB3Z,MAAO,CAAE6O,QAAOG,YAAvC,UACE,eAAC,GAAD,IACA,kCACE,eAAC,GAAD,IACA,eAAC,GAAD,OAEF,eAAC,GAAD,QCZN4K,IAASC,OACP,eAAC,IAAMC,WAAP,UACE,eAAC,GAAD,MAEFtJ,SAASuJ,eAAe,W","file":"static/js/main.c540b12c.chunk.js","sourcesContent":["export class DragSubject {\n  private type: Type;\n  private hOffset?: number;\n  private vOffset?: number;\n\n  static None(): DragSubject {\n    const out = new DragSubject();\n    out.type = Type.None;\n    return out;\n  }\n\n  static RVertex(hOffset: number, vOffset: number): DragSubject {\n    const out = new DragSubject();\n    out.type = Type.RVertex;\n    out.hOffset = hOffset;\n    out.vOffset = vOffset;\n    return out;\n  }\n\n  static HVertex(): DragSubject {\n    const out = new DragSubject();\n    out.type = Type.HVertex;\n    return out;\n  }\n\n  static VVertex(): DragSubject {\n    const out = new DragSubject();\n    out.type = Type.VVertex;\n    return out;\n  }\n\n  match<A>(handlers: Match<A>): A {\n    switch (this.type) {\n      case Type.None:\n        return handlers.none();\n      case Type.RVertex:\n        return handlers.r(this.hOffset as number, this.vOffset as number);\n      case Type.HVertex:\n        return handlers.h();\n      case Type.VVertex:\n        return handlers.v();\n    }\n  }\n}\n\nenum Type {\n  None = 'None',\n  RVertex = 'RVertex',\n  HVertex = 'HVertex',\n  VVertex = 'VVertex',\n}\n\nexport interface Match<A> {\n  none: () => A;\n  r: (hOffset: number, vOffset: number) => A;\n  h: () => A;\n  v: () => A;\n}\n","import { Vec } from './Vec';\n\nexport class Anim<A> {\n  constructor(public fn: AnimBehavior<A>, public duration: number) {}\n\n  then(after: Anim<A>): Anim<A> {\n    return new Anim(t => {\n      if (t < this.duration) {\n        return this.fn(t);\n      } else {\n        return after.fn(t - this.duration);\n      }\n    }, this.duration + after.duration);\n  }\n\n  static Wait<A>(value: A, duration: number): Anim<A> {\n    return new Anim(t => value, duration);\n  }\n\n  static Ease<V extends number | Vector>(\n    from: V,\n    to: V,\n    duration: number\n  ): Anim<V> {\n    if (typeof from === 'number' && typeof to === 'number') {\n      return Anim.EaseNumber(from, to, duration) as Anim<V>;\n    } else {\n      return Anim.EaseVector(from as Vector, to as Vector, duration) as Anim<V>;\n    }\n  }\n\n  static Fork<A>(anims: { [key: string]: Anim<any> }): Anim<A> {\n    const durations = Object.values(anims).map(({ duration }) => duration);\n    const duration = Math.max(...durations, 0);\n\n    return new Anim(t => {\n      const out = Object.keys(anims).reduce(\n        (acc, key) => ({\n          ...acc,\n          [key]: anims[key].fn(t),\n        }),\n        {}\n      );\n      return out;\n    }, duration) as Anim<A>;\n  }\n\n  private static EaseNumber(\n    from: number,\n    to: number,\n    duration: number\n  ): Anim<number> {\n    const diff = to - from;\n    return new Anim(t => {\n      if (t < duration) {\n        const tNorm = t / duration;\n        return from + diff * tNorm * tNorm * (3 - 2 * tNorm);\n      } else {\n        return to;\n      }\n    }, duration);\n  }\n\n  private static EaseVector<V extends Vector>(\n    from: V,\n    to: V,\n    duration: number\n  ): Anim<V> {\n    const diff = to.plus(from.times(-1));\n    return new Anim(t => {\n      if (t < duration) {\n        const tNorm = t / duration;\n        return from.plus(diff.times(tNorm * tNorm * (3 - 2 * tNorm)));\n      } else {\n        return to;\n      }\n    }, duration);\n  }\n}\n\ninterface AnimBehavior<A> {\n  (frame: number): A;\n}\n\nexport interface Vector {\n  plus(rhs: any): any;\n  times(scalar: any): any;\n}\n\nfunction animSvgPath(pts: Vec[], duration: number): Anim<string> {\n  const pts1 = [...pts, pts[0]];\n  const segmentDuration = duration / (pts1.length - 1);\n\n  return new Anim(t => {\n    if (t < duration) {\n      const seg = Math.floor(t / segmentDuration);\n      const from = pts1[seg];\n      const to = pts1[seg + 1];\n      const tNorm = (t - seg * segmentDuration) / segmentDuration;\n      const pos = from.plus(\n        to.minus(from).times(tNorm * tNorm * (3 - 2 * tNorm))\n      );\n      const fixed = pts1\n        .slice(0, seg + 1)\n        .map(pt => `${pt.x} ${pt.y}`)\n        .join(' L ');\n      return `M ${fixed} L ${pos.x} ${pos.y}`;\n    } else {\n      return `M ${pts.map(pt => `${pt.x} ${pt.y}`).join(' L ')} Z`;\n    }\n  }, duration);\n}\n\nfunction animMeasurement(\n  start: Vec,\n  end: Vec,\n  crossLength: number,\n  duration: number\n): Anim<string> {\n  const crossDuration = 0.2 * duration;\n  const lineDuration = 0.6 * duration;\n\n  const mainLine = end.minus(start);\n  const perp = mainLine\n    .perp()\n    .norm()\n    .times(crossLength / 2);\n  const crossStart1 = start.plus(perp);\n  const crossStart2 = start.minus(perp);\n  const crossEnd1 = end.plus(perp);\n  const crossEnd2 = end.minus(perp);\n  const fullCross = perp.times(-2);\n\n  const crossStartPath = `M ${crossStart1.x} ${crossStart1.y} L ${crossStart2.x} ${crossStart2.y}`;\n  const linePath = `M ${start.x} ${start.y} L ${end.x} ${end.y}`;\n  const crossEndPath = `M ${crossEnd1.x} ${crossEnd1.y} L ${crossEnd2.x} ${crossEnd2.y}`;\n\n  return new Anim(t => {\n    if (t < crossDuration) {\n      // First cross\n      const tNorm = t / crossDuration;\n      const crossPos = crossStart1.plus(fullCross.times(tNorm));\n      return `M ${crossStart1.x} ${crossStart1.y} L ${crossPos.x} ${crossPos.y}`;\n    } else if (crossDuration <= t && t < crossDuration + lineDuration) {\n      // Main line\n      const tNorm = (t - crossDuration) / lineDuration;\n      const linePos = start.plus(\n        mainLine.times(tNorm * tNorm * (3 - 2 * tNorm))\n      );\n      return `${crossStartPath} M ${start.x} ${start.y} L ${linePos.x} ${linePos.y}`;\n    } else if (\n      crossDuration + lineDuration <= t &&\n      t < crossDuration + lineDuration + crossDuration\n    ) {\n      // Second cross\n      const tNorm = (t - crossDuration - lineDuration) / crossDuration;\n      const crossPos = crossEnd1.plus(fullCross.times(tNorm));\n      return `${crossStartPath} ${linePath} M ${crossEnd1.x} ${crossEnd1.y} L ${crossPos.x} ${crossPos.y}`;\n    } else {\n      // Full path\n      return `${crossStartPath} ${linePath} ${crossEndPath}`;\n    }\n  }, duration);\n}\n\nexport const Extras = {\n  SvgPath: animSvgPath,\n  Measurement: animMeasurement,\n};\n","import { Vector } from './Anim';\n\nexport class Vec implements Vector {\n  constructor(public x: number, public y: number) {}\n\n  plus(rhs: Vec): Vec {\n    return new Vec(this.x + rhs.x, this.y + rhs.y);\n  }\n\n  times(scalar: number): Vec {\n    return new Vec(scalar * this.x, scalar * this.y);\n  }\n\n  minus(rhs: Vec): Vec {\n    return new Vec(this.x - rhs.x, this.y - rhs.y);\n  }\n\n  length(): number {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n\n  norm(): Vec {\n    const length = this.length();\n    if (length === 0) {\n      throw new Error('attempt to norm 0-vector');\n    }\n\n    return this.times(1 / length);\n  }\n\n  dot(rhs: Vec): number {\n    return this.x * rhs.x + this.y * rhs.y;\n  }\n\n  proj(rhs: Vec): Vec {\n    const denom = rhs.dot(rhs);\n    if (denom === 0) {\n      throw new Error('attempt to project onto the 0-vector');\n    }\n\n    const num = this.dot(rhs);\n    return rhs.times(num / denom);\n  }\n\n  perp(): Vec {\n    return new Vec(-this.y, this.x);\n  }\n\n  rotate(angle: number): Vec {\n    const { x, y } = this;\n    const cos = Math.cos(angle);\n    const sin = Math.sin(angle);\n\n    return new Vec(cos * x - sin * y, sin * x + cos * y);\n  }\n\n  cross(rhs: Vec): number {\n    return this.x * rhs.y - this.y * rhs.x;\n  }\n}\n","import { Vector } from './index';\nimport { Vec } from './Vec';\n\nexport class Pose implements Vector {\n  constructor(public loc: Vec, public angle: number) {}\n\n  plus(rhs: Pose): Pose {\n    return new Pose(this.loc.plus(rhs.loc), this.angle + rhs.angle);\n  }\n\n  times(scalar: number): Pose {\n    return new Pose(this.loc.times(scalar), scalar * this.angle);\n  }\n}\n","export * from './Anim';\nexport * from './Vec';\nexport * from './Pose';\n\nexport function sign(n: number): number {\n  if (n >= 0) {\n    return 1;\n  } else {\n    return -1;\n  }\n}\n\nexport function memo<A, B>(fn: (x: A) => B): (x: A) => B {\n  let cachedInput: A;\n  let cachedOutput: B;\n\n  return (x: A) => {\n    if (cachedInput && cachedInput === x) {\n      return cachedOutput;\n    }\n\n    cachedInput = x;\n    cachedOutput = fn(x);\n    return cachedOutput;\n  };\n}\n","import { DragSubject } from './DragSubject';\nimport { Vec } from '../tools';\n\nexport interface State {\n  ui: UIState;\n  tri: RightTriangle;\n  dragSubject: DragSubject;\n  stepIndex: number;\n}\n\nexport interface UIState {\n  dims: Dims;\n  triOutOfBounds: boolean;\n}\n\nexport const initTri: RightTriangle = {\n  r: new Vec(-70, 0),\n  h: new Vec(70, 0),\n  v: new Vec(-70, -80),\n};\n\nexport const initState: State = {\n  ui: {\n    dims: { width: 0, height: 0 },\n    triOutOfBounds: false,\n  },\n  tri: initTri,\n  dragSubject: DragSubject.None(),\n  stepIndex: 0,\n};\n\n// v -> *\n//      |\\\n//      | \\\n// r -> *--* <- h\nexport interface RightTriangle {\n  r: Vec;\n  h: Vec;\n  v: Vec;\n}\n\nexport interface Dims {\n  width: number;\n  height: number;\n}\n","import { Vec } from '../tools';\nimport { Dims } from './state';\n\nexport interface Action {\n  type: string;\n  payload?: any;\n}\n\nexport enum ActionType {\n  PreviousStep = 'PreviousStep',\n  NextStep = 'NextStep',\n  MouseDownRVertex = 'MouseDownRVertex',\n  MouseDownHVertex = 'MouseDownHVertex',\n  MouseDownVVertex = 'MouseDownVVertex',\n  MouseMove = 'MouseMove',\n  MouseUp = 'MouseUp',\n  MakeThin = 'MakeThin',\n  MakeEven = 'MakeEven',\n  UpdateDims = 'UpdateDims',\n  ResetMainTriangle = 'ResetMainTriangle',\n}\n\nexport function previousStep(): Action {\n  return { type: ActionType.PreviousStep };\n}\n\nexport function nextStep(): Action {\n  return { type: ActionType.NextStep };\n}\n\nexport function mouseDownRVertex(): Action {\n  return { type: ActionType.MouseDownRVertex };\n}\n\nexport function mouseDownHVertex(): Action {\n  return { type: ActionType.MouseDownHVertex };\n}\n\nexport function mouseDownVVertex(): Action {\n  return { type: ActionType.MouseDownVVertex };\n}\n\nexport function mouseMove(pos: Vec): Action {\n  return { type: ActionType.MouseMove, payload: pos };\n}\n\nexport function mouseUp(): Action {\n  return { type: ActionType.MouseUp };\n}\n\nexport function makeThin(): Action {\n  return { type: ActionType.MakeThin };\n}\n\nexport function makeEven(): Action {\n  return { type: ActionType.MakeEven };\n}\n\nexport function updateDims(dims: Dims): Action {\n  return { type: ActionType.UpdateDims, payload: dims };\n}\n\nexport function resetMainTriangle(): Action {\n  return { type: ActionType.ResetMainTriangle };\n}\n","import { Vec, Pose, memo } from '../tools';\nimport { RightTriangle } from '../state';\n\ninterface Selector<A> {\n  (tri: RightTriangle): A;\n}\n\nexport const vr: Selector<Vec> = memo(tri => tri.r.minus(tri.v));\n\nexport const hr: Selector<Vec> = memo(tri => tri.r.minus(tri.h));\n\nexport const vh: Selector<Vec> = memo(tri => tri.h.minus(tri.v));\n\nexport const rv: Selector<Vec> = memo(tri => vr(tri).times(-1));\n\nexport const rh: Selector<Vec> = memo(tri => hr(tri).times(-1));\n\nexport const aPerpNorm: Selector<Vec> = memo(tri => {\n  return hr(tri).norm();\n});\n\nexport const aPerp: Selector<Vec> = memo(tri => {\n  const length = vr(tri).length();\n  return aPerpNorm(tri).times(length);\n});\n\nexport const a0: Selector<Vec> = memo(tri => {\n  return tri.v.plus(aPerp(tri));\n});\n\nexport const a1: Selector<Vec> = memo(tri => {\n  return tri.r.plus(aPerp(tri));\n});\n\nexport const aSquare: Selector<Vec[]> = memo(tri => [\n  tri.v,\n  a0(tri),\n  a1(tri),\n  tri.r,\n]);\n\nexport const aSquareLabel: Selector<Vec> = memo(tri => {\n  const half = a0(tri)\n    .minus(tri.r)\n    .times(1 / 2);\n  return tri.r.plus(half);\n});\n\nexport const bPerpNorm: Selector<Vec> = memo(tri => {\n  return vr(tri).norm();\n});\n\nexport const bPerp: Selector<Vec> = memo(tri => {\n  const length = hr(tri).length();\n  return bPerpNorm(tri).times(length);\n});\n\nexport const b0: Selector<Vec> = memo(tri => {\n  return tri.r.plus(bPerp(tri));\n});\n\nexport const b1: Selector<Vec> = memo(tri => {\n  return tri.h.plus(bPerp(tri));\n});\n\nexport const bSquare: Selector<Vec[]> = memo(tri => [\n  tri.r,\n  b0(tri),\n  b1(tri),\n  tri.h,\n]);\n\nexport const bSquareLabel: Selector<Vec> = memo(tri => {\n  const half = b0(tri)\n    .minus(tri.h)\n    .times(1 / 2);\n  return tri.h.plus(half);\n});\n\nexport const cPerpNorm: Selector<Vec> = memo(tri => {\n  const vh1 = vh(tri);\n  const vr1 = vr(tri);\n  const proj = vr1.proj(vh1);\n  return proj.minus(vr1).norm();\n});\n\nexport const cPerp: Selector<Vec> = memo(tri => {\n  const length = vh(tri).length();\n  return cPerpNorm(tri).times(length);\n});\n\nexport const c0: Selector<Vec> = memo(tri => {\n  return tri.h.plus(cPerp(tri));\n});\n\nexport const c1: Selector<Vec> = memo(tri => {\n  return tri.v.plus(cPerp(tri));\n});\n\nexport const cSquare: Selector<Vec[]> = memo(tri => [\n  tri.h,\n  c0(tri),\n  c1(tri),\n  tri.v,\n]);\n\nexport const cSquareLabel: Selector<Vec> = memo(tri => {\n  const half = c0(tri)\n    .minus(tri.v)\n    .times(1 / 2);\n  return tri.v.plus(half);\n});\n\nexport const abOut: Selector<Vec> = memo(tri => {\n  return b0(tri).plus(aPerp(tri));\n});\n\nexport const abIn: Selector<Vec> = memo(tri => {\n  return tri.h.plus(rv(tri));\n});\n\nexport const cAuxV: Selector<Vec> = memo(tri => {\n  const hrLength = hr(tri).length();\n  const vert = rv(tri).norm().times(hrLength);\n  return tri.v.plus(vert);\n});\n\nexport const cAuxDiag: Selector<Vec> = memo(tri => {\n  const rh1 = rh(tri);\n  const length = rh1.length() + vr(tri).length();\n  const out = rh1.norm().times(length);\n  return cAuxV(tri).plus(out);\n});\n\nexport const cAuxH: Selector<Vec> = memo(tri => {\n  const vrLength = vr(tri).length();\n  const horiz = rh(tri).norm().times(vrLength);\n  return tri.h.plus(horiz);\n});\n\nconst SIDE_MEASURE_OFFSET = 30;\n\nexport const aMeasurementPerp: Selector<Vec> = memo(tri =>\n  aPerpNorm(tri).times(SIDE_MEASURE_OFFSET)\n);\n\nexport const aMeasurementStart: Selector<Vec> = memo(tri =>\n  tri.v.plus(aMeasurementPerp(tri))\n);\n\nexport const aMeasurementEnd: Selector<Vec> = memo(tri =>\n  tri.r.plus(aMeasurementPerp(tri))\n);\n\nexport const bMeasurementPerp: Selector<Vec> = memo(tri =>\n  bPerpNorm(tri).times(SIDE_MEASURE_OFFSET)\n);\n\nexport const bMeasurementStart: Selector<Vec> = memo(tri =>\n  tri.r.plus(bMeasurementPerp(tri))\n);\n\nexport const bMeasurementEnd: Selector<Vec> = memo(tri =>\n  tri.h.plus(bMeasurementPerp(tri))\n);\n\nexport const cMeasurementPerp: Selector<Vec> = memo(tri =>\n  cPerpNorm(tri).times(SIDE_MEASURE_OFFSET)\n);\n\nexport const cMeasurementStart: Selector<Vec> = memo(tri =>\n  tri.h.plus(cMeasurementPerp(tri))\n);\n\nexport const cMeasurementEnd: Selector<Vec> = memo(tri =>\n  tri.v.plus(cMeasurementPerp(tri))\n);\n\nconst SIDE_LABEL_OFFSET = 20;\n\nexport const aMeasurementLabel: Selector<Vec> = memo(tri => {\n  const start = aMeasurementStart(tri);\n  const end = aMeasurementEnd(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = aPerpNorm(tri).times(SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const bMeasurementLabel: Selector<Vec> = memo(tri => {\n  const start = bMeasurementStart(tri);\n  const end = bMeasurementEnd(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = bPerpNorm(tri).times(SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const cMeasurementLabel: Selector<Vec> = memo(tri => {\n  const start = cMeasurementStart(tri);\n  const end = cMeasurementEnd(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = cPerpNorm(tri).times(SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const abAuxSquare: Selector<Vec[]> = memo(tri => [\n  tri.v,\n  a0(tri),\n  abOut(tri),\n  b1(tri),\n  abIn(tri),\n]);\n\nexport const cAuxSquare: Selector<Vec[]> = memo(tri => [\n  tri.r,\n  cAuxV(tri),\n  cAuxDiag(tri),\n  cAuxH(tri),\n]);\n\nexport const abMeasurementHOut: Selector<Vec> = memo(tri => {\n  const vA0 = a0(tri).minus(tri.v);\n  const out = vA0.norm().times(SIDE_MEASURE_OFFSET);\n  return vA0.plus(out);\n});\n\nexport const abMeasurementVOut: Selector<Vec> = memo(tri => {\n  const hB1 = b1(tri).minus(tri.h);\n  const out = hB1.norm().times(SIDE_MEASURE_OFFSET);\n  return hB1.plus(out);\n});\n\nexport const aSquareMeasurement1Start: Selector<Vec> = memo(tri =>\n  tri.v.plus(abMeasurementHOut(tri))\n);\n\nexport const aSquareMeasurement1End: Selector<Vec> = memo(tri =>\n  tri.r.plus(abMeasurementHOut(tri))\n);\n\nexport const bSquareMeasurement1Start: Selector<Vec> = aSquareMeasurement1End;\n\nexport const bSquareMeasurement1End: Selector<Vec> = memo(tri =>\n  b0(tri).plus(abMeasurementHOut(tri))\n);\n\nexport const aSquareMeasurement1Label: Selector<Vec> = memo(tri => {\n  const start = aSquareMeasurement1Start(tri);\n  const end = aSquareMeasurement1End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = aPerpNorm(tri).times(SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const bSquareMeasurement1Label: Selector<Vec> = memo(tri => {\n  const start = bSquareMeasurement1Start(tri);\n  const end = bSquareMeasurement1End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = aPerpNorm(tri).times(SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const aSquareMeasurement2Start: Selector<Vec> = memo(tri =>\n  a1(tri).plus(abMeasurementVOut(tri))\n);\n\nexport const aSquareMeasurement2End: Selector<Vec> = memo(tri =>\n  tri.r.plus(abMeasurementVOut(tri))\n);\n\nexport const bSquareMeasurement2Start: Selector<Vec> = aSquareMeasurement2End;\n\nexport const bSquareMeasurement2End: Selector<Vec> = memo(tri =>\n  tri.h.plus(abMeasurementVOut(tri))\n);\n\nexport const aSquareMeasurement2Label: Selector<Vec> = memo(tri => {\n  const start = aSquareMeasurement2Start(tri);\n  const end = aSquareMeasurement2End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = bPerpNorm(tri).times(SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const bSquareMeasurement2Label: Selector<Vec> = memo(tri => {\n  const start = bSquareMeasurement2Start(tri);\n  const end = bSquareMeasurement2End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = bPerpNorm(tri).times(SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const isRightHanded: Selector<boolean> = memo(\n  tri => rh(tri).cross(rv(tri)) >= 0\n);\n\nexport const initTriPose: Selector<Pose> = memo(tri => new Pose(tri.r, 0));\n\nexport const triCopyPts: Selector<Vec[]> = memo(tri => [\n  new Vec(0, 0),\n  rh(tri),\n  rv(tri),\n]);\n\nexport const triCopyC1Pose: Selector<Pose> = memo(tri => {\n  const angle = isRightHanded(tri) ? -Math.PI / 2 : Math.PI / 2;\n  return new Pose(cAuxV(tri), angle);\n});\n\nexport const triCopyC2Pose: Selector<Pose> = memo(\n  tri => new Pose(cAuxDiag(tri), Math.PI)\n);\n\nexport const triCopyC3Pose: Selector<Pose> = memo(tri => {\n  const angle = isRightHanded(tri) ? (-3 * Math.PI) / 2 : (3 * Math.PI) / 2;\n  return new Pose(cAuxH(tri), angle);\n});\n\nexport const triCopyAB1Pose: Selector<Pose> = memo(\n  tri => new Pose(abIn(tri), Math.PI)\n);\n\nexport const triCopyAB2Pose: Selector<Pose> = memo(tri => {\n  const angle = isRightHanded(tri) ? -Math.PI / 2 : Math.PI / 2;\n  return new Pose(a1(tri), angle);\n});\n\nexport const triCopyAB3Pose: Selector<Pose> = memo(tri => {\n  const angle = isRightHanded(tri) ? Math.PI / 2 : -Math.PI / 2;\n  return new Pose(b0(tri), angle);\n});\n\nexport const cMeasurementVOut: Selector<Vec> = memo(tri =>\n  rv(tri).norm().times(SIDE_MEASURE_OFFSET)\n);\n\nexport const cMeasurementHOut: Selector<Vec> = memo(tri =>\n  rh(tri).norm().times(SIDE_MEASURE_OFFSET)\n);\n\nexport const cSquareMeasurementA1Start: Selector<Vec> = memo(tri =>\n  cAuxV(tri).plus(cMeasurementVOut(tri))\n);\n\nexport const cSquareMeasurementA1End: Selector<Vec> = memo(tri =>\n  c1(tri).plus(cMeasurementVOut(tri))\n);\n\nexport const cSquareMeasurementB1Start: Selector<Vec> = cSquareMeasurementA1End;\n\nexport const cSquareMeasurementB1End: Selector<Vec> = memo(tri =>\n  cAuxDiag(tri).plus(cMeasurementVOut(tri))\n);\n\nexport const cSquareMeasurementA1Label: Selector<Vec> = memo(tri => {\n  const start = cSquareMeasurementA1Start(tri);\n  const end = cSquareMeasurementA1End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = bPerpNorm(tri).times(-SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const cSquareMeasurementB1Label: Selector<Vec> = memo(tri => {\n  const start = cSquareMeasurementB1Start(tri);\n  const end = cSquareMeasurementB1End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = bPerpNorm(tri).times(-SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const cSquareMeasurementA2Start: Selector<Vec> = memo(tri =>\n  cAuxDiag(tri).plus(cMeasurementHOut(tri))\n);\n\nexport const cSquareMeasurementA2End: Selector<Vec> = memo(tri =>\n  c0(tri).plus(cMeasurementHOut(tri))\n);\n\nexport const cSquareMeasurementB2Start: Selector<Vec> = cSquareMeasurementA2End;\n\nexport const cSquareMeasurementB2End: Selector<Vec> = memo(tri =>\n  cAuxH(tri).plus(cMeasurementHOut(tri))\n);\n\nexport const cSquareMeasurementA2Label: Selector<Vec> = memo(tri => {\n  const start = cSquareMeasurementA2Start(tri);\n  const end = cSquareMeasurementA2End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = aPerpNorm(tri).times(-SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n\nexport const cSquareMeasurementB2Label: Selector<Vec> = memo(tri => {\n  const start = cSquareMeasurementB2Start(tri);\n  const end = cSquareMeasurementB2End(tri);\n  const half = end.minus(start).times(1 / 2);\n  const out = aPerpNorm(tri).times(-SIDE_LABEL_OFFSET);\n  return start.plus(half).plus(out);\n});\n","import React from 'react';\n\nexport function useAnimationFrame(duration: number): UseAnimationFrame {\n  const rafHandle = React.useRef<number>();\n  const start = React.useRef<number>();\n  const pausedFrame = React.useRef<number>(0);\n  const [isPlaying, setIsPlaying] = React.useState(true);\n  const [frame, setFrame] = React.useState(0);\n\n  const step = React.useCallback(\n    (timestamp: number) => {\n      if (start.current === undefined) {\n        start.current = timestamp;\n      }\n\n      const currentFrame = timestamp - start.current + pausedFrame.current;\n      setFrame(currentFrame);\n\n      if (currentFrame < duration) {\n        rafHandle.current = window.requestAnimationFrame(step);\n      }\n    },\n    [duration]\n  );\n\n  React.useEffect(() => {\n    rafHandle.current = window.requestAnimationFrame(step);\n    pausedFrame.current = 0;\n    setIsPlaying(true);\n\n    return () => {\n      window.cancelAnimationFrame(rafHandle.current as number);\n    };\n  }, [step]);\n\n  const togglePlay = React.useCallback(() => {\n    if (isPlaying) {\n      setIsPlaying(false);\n      pausedFrame.current = frame;\n      start.current = undefined;\n      window.cancelAnimationFrame(rafHandle.current as number);\n    } else {\n      setIsPlaying(true);\n      rafHandle.current = window.requestAnimationFrame(step);\n    }\n  }, [isPlaying, frame, step]);\n\n  const updateFrame = React.useCallback((frame: Frame) => {\n    setFrame(frame);\n    setIsPlaying(false);\n    pausedFrame.current = frame;\n    start.current = undefined;\n    window.cancelAnimationFrame(rafHandle.current as number);\n  }, []);\n\n  const restart = React.useCallback(() => {\n    setFrame(0);\n    setIsPlaying(true);\n    pausedFrame.current = 0;\n    start.current = undefined;\n    rafHandle.current = window.requestAnimationFrame(step);\n  }, [step]);\n\n  return {\n    frame,\n    isPlaying,\n    duration,\n    setFrame: updateFrame,\n    togglePlay,\n    restart,\n  };\n}\n\nexport interface UseAnimationFrame {\n  frame: Frame;\n  isPlaying: boolean;\n  duration: number;\n  setFrame: (frame: Frame) => void;\n  togglePlay: () => void;\n  restart: () => void;\n}\n\nexport type Frame = number;\n","import React from 'react';\nimport { StateContext } from './state';\nimport { Locations as L } from './steps';\nimport { Vec } from './tools';\n\nconst DebugPoints: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n  const { tri } = state;\n\n  const { r, h, v } = tri;\n\n  const a0 = L.a0(tri);\n  const a1 = L.a1(tri);\n  const b0 = L.b0(tri);\n  const b1 = L.b1(tri);\n  const c0 = L.c0(tri);\n  const c1 = L.c1(tri);\n\n  const abOut = L.abOut(tri);\n  const abIn = L.abIn(tri);\n  const cAuxV = L.cAuxV(tri);\n  const cAuxDiag = L.cAuxDiag(tri);\n  const cAuxH = L.cAuxH(tri);\n\n  return (\n    <g>\n      {/* Main Triangle Points */}\n      <DebugPoint name=\"r\" pos={r} />\n      <DebugPoint name=\"h\" pos={h} />\n      <DebugPoint name=\"v\" pos={v} />\n\n      {/* Main Squares */}\n      <DebugPolygon pts={[v, a0, a1, r]} />\n      <DebugPolygon pts={[r, b0, b1, h]} />\n      <DebugPolygon pts={[h, c0, c1, v]} />\n      <DebugPoint name=\"a0\" pos={a0} />\n      <DebugPoint name=\"a1\" pos={a1} />\n      <DebugPoint name=\"b0\" pos={b0} />\n      <DebugPoint name=\"b1\" pos={b1} />\n      <DebugPoint name=\"c0\" pos={c0} />\n      <DebugPoint name=\"c1\" pos={c1} />\n\n      {/* Auxiliary Squares */}\n      <DebugPolygon pts={[v, a0, abOut, b1, abIn]} />\n      <DebugPolygon pts={[r, cAuxV, cAuxDiag, cAuxH]} />\n      <DebugPoint name=\"abOut\" pos={abOut} />\n      <DebugPoint name=\"abIn\" pos={abIn} />\n      <DebugPoint name=\"cAuxV\" pos={cAuxV} />\n      <DebugPoint name=\"cAuxDiag\" pos={cAuxDiag} />\n      <DebugPoint name=\"cAuxH\" pos={cAuxH} />\n    </g>\n  );\n};\n\ninterface DebugPointProps {\n  name: string;\n  pos: Vec;\n}\n\nconst DebugPoint: React.FC<DebugPointProps> = props => {\n  const { name, pos } = props;\n  const { x, y } = pos;\n\n  return (\n    <g className=\"debug-point\">\n      <text x={x} y={y} dx=\"0.5em\" dy=\"-0.3em\">\n        {name}\n      </text>\n      <circle cx={x} cy={y} r=\"5\" />\n    </g>\n  );\n};\n\ninterface DebugPolygonProps {\n  pts: Vec[];\n}\n\nconst DebugPolygon: React.FC<DebugPolygonProps> = props => {\n  const { pts } = props;\n\n  const d = `M ${pts.map(pt => `${pt.x} ${pt.y}`).join(' L ')} Z`;\n\n  return <path className=\"debug-polygon\" d={d} />;\n};\n\nexport default DebugPoints;\n","import React from 'react';\nimport { StateContext, Actions as A, Selectors as S, Dims } from './state';\nimport { useDims, useMouse } from './hooks';\nimport { Vec } from './tools';\nimport DebugPoints from './DebugPoints';\n\nexport interface CanvasProps {\n  debug?: boolean;\n}\n\nconst Canvas: React.FC<CanvasProps> = props => {\n  const { state, dispatch } = React.useContext(StateContext);\n  const ref = React.useRef<HTMLElement>(null);\n  const reportDimsChange = React.useCallback(\n    (dims: Dims) => dispatch(A.updateDims(dims)),\n    [dispatch]\n  );\n  useDims(ref, reportDimsChange);\n\n  const dims = S.dims(state);\n  const centerX = dims.width / 2;\n  const centerY = dims.height / 2;\n\n  useMouse(ref, {\n    onMove: pos =>\n      dispatch(A.mouseMove(new Vec(pos.x - centerX, pos.y - centerY))),\n    onUp: () => dispatch(A.mouseUp()),\n  });\n\n  const translation = `translate(${centerX} ${centerY})`;\n\n  return (\n    <svg\n      id=\"canvas\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      ref={ref as any as React.RefObject<SVGSVGElement>}\n    >\n      <g transform={`${translation}`}>\n        {props.children}\n        {props.debug && <DebugPoints />}\n      </g>\n    </svg>\n  );\n};\n\nexport default Canvas;\n","import React from 'react';\nimport { Dims } from '../state';\n\nexport function useDims<E extends HTMLElement>(\n  ref: React.RefObject<E>,\n  onChange: (dims: Dims) => void\n): Dims {\n  const [dims, setDims] = React.useState({ width: 0, height: 0 });\n\n  React.useEffect(() => {\n    function computeDims() {\n      if (ref.current) {\n        const { width, height } = ref.current.getBoundingClientRect();\n        const dims = { width, height };\n        onChange(dims);\n        return setDims(dims);\n      }\n    }\n\n    computeDims();\n\n    window.addEventListener('resize', computeDims);\n    return () => window.removeEventListener('resize', computeDims);\n  }, [ref, onChange]);\n\n  return dims;\n}\n","import React from 'react';\nimport { Vec } from '../tools';\n\nexport function useMouse<E extends HTMLElement>(\n  ref: React.RefObject<E>,\n  handlers: Handlers\n) {\n  const [bounds, setBounds] = React.useState({ left: 0, top: 0 });\n\n  const { onMove, onUp } = handlers;\n\n  React.useEffect(() => {\n    function computeBounds() {\n      if (ref.current) {\n        const { left, top } = ref.current.getBoundingClientRect();\n        return setBounds({ left, top });\n      }\n    }\n\n    computeBounds();\n\n    window.addEventListener('resize', computeBounds);\n    return () => window.removeEventListener('resize', computeBounds);\n  }, [ref]);\n\n  React.useEffect(() => {\n    function handleMove(e: MouseEvent) {\n      const { left, top } = bounds;\n      const { clientX, clientY } = e;\n      return onMove(new Vec(clientX - left, clientY - top));\n    }\n\n    document.addEventListener('mousemove', handleMove);\n    return () => document.removeEventListener('mousemove', handleMove);\n  }, [onMove, bounds]);\n\n  React.useEffect(() => {\n    function handleUp() {\n      return onUp();\n    }\n\n    document.addEventListener('mouseup', handleUp);\n    return () => document.removeEventListener('mouseup', handleUp);\n  }, [onUp]);\n\n  return ref;\n}\n\nexport interface Handlers {\n  onMove: (pos: Vec) => unknown;\n  onUp: () => unknown;\n}\n","import React from 'react';\n\nexport interface ControlsProps {\n  frame: number;\n  isPlaying: boolean;\n  duration: number;\n  togglePlay: () => void;\n  setFrame: (frame: number) => void;\n  restart: () => void;\n}\n\nconst Controls: React.FC<ControlsProps> = props => {\n  const { frame, isPlaying, duration, togglePlay, setFrame, restart } = props;\n\n  function handleChange(e: React.ChangeEvent<HTMLInputElement>) {\n    return setFrame(Number(e.target.value));\n  }\n\n  function handleClick() {\n    if (frame >= duration) {\n      return restart();\n    } else {\n      return togglePlay();\n    }\n  }\n\n  const buttonText =\n    frame >= duration ? 'Restart' : isPlaying ? 'Pause' : 'Play';\n\n  return (\n    <div id=\"controls\">\n      <button onClick={handleClick}>{buttonText}</button>\n\n      <input\n        type=\"range\"\n        min={0}\n        max={duration}\n        value={frame}\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nexport default Controls;\n","import React from 'react';\nimport { StateContext, Actions as A } from './state';\n\nexport const CONTROL_POINT_RADIUS = 8;\n\nexport interface ControlPointsProps {\n  rOpacity?: number;\n  hOpacity?: number;\n  vOpacity?: number;\n}\n\nconst ControlPoints: React.FC<ControlPointsProps> = props => {\n  const { state, dispatch } = React.useContext(StateContext);\n  const { rOpacity = 1, hOpacity = 1, vOpacity = 1 } = props;\n\n  const { r, h, v } = state.tri;\n\n  function handleRDown() {\n    return dispatch(A.mouseDownRVertex());\n  }\n\n  function handleHDown() {\n    return dispatch(A.mouseDownHVertex());\n  }\n\n  function handleVDown() {\n    return dispatch(A.mouseDownVVertex());\n  }\n\n  return (\n    <g>\n      <circle\n        className=\"control-point\"\n        cx={r.x}\n        cy={r.y}\n        r={CONTROL_POINT_RADIUS}\n        fillOpacity={rOpacity}\n        onMouseDown={handleRDown}\n      />\n      <circle\n        className=\"control-point\"\n        cx={h.x}\n        cy={h.y}\n        r={CONTROL_POINT_RADIUS}\n        fillOpacity={hOpacity}\n        onMouseDown={handleHDown}\n      />\n      <circle\n        className=\"control-point\"\n        cx={v.x}\n        cy={v.y}\n        r={CONTROL_POINT_RADIUS}\n        fillOpacity={vOpacity}\n        onMouseDown={handleVDown}\n      />\n    </g>\n  );\n};\n\nexport default ControlPoints;\n","import React from 'react';\nimport { StateContext } from './state';\n\nexport interface MainTriangleProps {\n  d?: string;\n  opacity?: number;\n  strokeOpacity?: number;\n}\n\nconst MainTriangle: React.FC<MainTriangleProps> = props => {\n  const { state } = React.useContext(StateContext);\n  const { r, h, v } = state.tri;\n\n  const fullPath = `M ${r.x} ${r.y} L ${h.x} ${h.y} L ${v.x} ${v.y} Z`;\n\n  const { d = fullPath, opacity = 1, strokeOpacity = 1 } = props;\n\n  return (\n    <path\n      className=\"main-triangle\"\n      d={d}\n      fillOpacity={opacity}\n      strokeOpacity={strokeOpacity}\n    />\n  );\n};\n\nexport default MainTriangle;\n","import React from 'react';\nimport { Vec } from './tools';\n\nexport interface MeasurementProps {\n  d: string;\n  label: string;\n  labelPos: Vec;\n  labelOpacity: number;\n}\n\nconst Measurement: React.FC<MeasurementProps> = props => {\n  const { d, label, labelPos, labelOpacity } = props;\n\n  return (\n    <g>\n      <path className=\"measurement-path\" d={d} />\n      <text\n        className=\"measurement-label\"\n        x={labelPos.x}\n        y={labelPos.y}\n        fillOpacity={labelOpacity}\n        textAnchor=\"middle\"\n        dominantBaseline=\"middle\"\n      >\n        {label}\n      </text>\n    </g>\n  );\n};\n\nexport default Measurement;\n","import React from 'react';\nimport * as L from './locations';\nimport { StateContext, RightTriangle } from '../state';\nimport { useAnimationFrame } from '../hooks';\nimport { Anim, Extras as AnimExtras } from '../tools';\nimport Canvas from '../Canvas';\nimport Controls from '../Controls';\nimport ControlPoints from '../ControlPoints';\nimport MainTriangle from '../MainTriangle';\nimport Measurement from '../Measurement';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h1>A Pythagorean Mosaic</h1>\n\n      <p>\n        The celebrated <em>Pythagorean Theorem</em> says that the relationship\n        between the lengths of the sides of any right triangle is astonishingly\n        simple: specifically, the square of the length of the longest side (the\n        &ldquo;hypotenuse&rdquo;) is equal to the sum of the squares of the\n        shorter sides. Following convention, if we call the length of the\n        hypotenuse <code>c</code>, and the lengths of the remaining sides{' '}\n        <code>a</code> and <code>b</code>, the Pythagorean Theorem states that{' '}\n        <code>\n          a<sup>2</sup> + b<sup>2</sup> = c<sup>2</sup>\n        </code>\n        .\n      </p>\n      <p>\n        How do we <em>know</em> that this is true? Perhaps we could (somehow)\n        check a large collection of right triangles to see if this is always the\n        case. Although such an effort might instill some confidence, it would be\n        far from definitive: inevitably, we'd remain tormented by the nagging\n        thought that we'd missed some exotic conjecture-defying triangle.\n      </p>\n      <p>\n        We want something sturdier: a <em>proof</em>. In the remaining pages,\n        we'll step through a tidy demonstration of the Pythagorean Theorem.\n        Unlike the &ldquo;checking&rdquo; strategy described above, our proof\n        will appeal to universal properties of right triangles and other\n        geometric figures, rather than relying on the specific details of any\n        particular triangle.\n      </p>\n\n      <p>\n        We'll use the right triangle shown here to illustrate each step. Each of\n        the triangle's vertices (<span className=\"dummy-control-point\"></span>)\n        can be dragged at any time; this will allow us to observe each step with\n        a variety of different triangles.\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const controlPoints = React.useMemo(\n    () => animControlPoints(state.tri),\n    [state.tri]\n  );\n  const triangle = React.useMemo(() => animTriangle(state.tri), [state.tri]);\n  const measurements = React.useMemo(\n    () => animMeasurements(state.tri),\n    [state.tri]\n  );\n\n  const totalDuration = Math.max(\n    controlPoints.duration,\n    triangle.duration,\n    measurements.duration\n  );\n  const animControls = useAnimationFrame(totalDuration);\n  const { frame } = animControls;\n\n  const { rOpacity, hOpacity, vOpacity } = controlPoints.fn(frame);\n  const { d, opacity } = triangle.fn(frame);\n  const { dA, aOpacity, dB, bOpacity, dC, cOpacity } = measurements.fn(frame);\n\n  const aLabelPos = L.aMeasurementLabel(state.tri);\n  const bLabelPos = L.bMeasurementLabel(state.tri);\n  const cLabelPos = L.cMeasurementLabel(state.tri);\n\n  return (\n    <>\n      <Canvas>\n        <Measurement\n          d={dA}\n          label=\"a\"\n          labelPos={aLabelPos}\n          labelOpacity={aOpacity}\n        />\n        <Measurement\n          d={dB}\n          label=\"b\"\n          labelPos={bLabelPos}\n          labelOpacity={bOpacity}\n        />\n        <Measurement\n          d={dC}\n          label=\"c\"\n          labelPos={cLabelPos}\n          labelOpacity={cOpacity}\n        />\n\n        <MainTriangle d={d} opacity={opacity} />\n        <ControlPoints\n          rOpacity={rOpacity}\n          hOpacity={hOpacity}\n          vOpacity={vOpacity}\n        />\n      </Canvas>\n\n      <Controls {...animControls} />\n    </>\n  );\n};\n\nfunction animControlPoints(tri: RightTriangle): Anim<ControlPointsState> {\n  return Anim.Fork({\n    vOpacity: Anim.Ease(0, 1, 400),\n    rOpacity: Anim.Wait(0, 600).then(Anim.Ease(0, 1, 400)),\n    hOpacity: Anim.Wait(0, 1200).then(Anim.Ease(0, 1, 400)),\n  });\n}\n\ninterface ControlPointsState {\n  rOpacity: number;\n  hOpacity: number;\n  vOpacity: number;\n}\n\nfunction animTriangle(tri: RightTriangle): Anim<TriangleState> {\n  const { r, h, v } = tri;\n\n  return Anim.Fork({\n    d: AnimExtras.SvgPath([v, r, h], 1800),\n    opacity: Anim.Wait(0, 2400).then(Anim.Ease(0, 1, 500)),\n  });\n}\n\ninterface TriangleState {\n  d: string;\n  opacity: number;\n}\n\nfunction animMeasurements(tri: RightTriangle): Anim<MeasurementsState> {\n  return Anim.Fork({\n    dA: Anim.Wait('', 3000).then(\n      AnimExtras.Measurement(\n        L.aMeasurementStart(tri),\n        L.aMeasurementEnd(tri),\n        20,\n        1600\n      )\n    ),\n    aOpacity: Anim.Wait(0, 4600).then(Anim.Ease(0, 1, 800)),\n    dB: Anim.Wait('', 5000).then(\n      AnimExtras.Measurement(\n        L.bMeasurementStart(tri),\n        L.bMeasurementEnd(tri),\n        20,\n        1600\n      )\n    ),\n    bOpacity: Anim.Wait(0, 6600).then(Anim.Ease(0, 1, 800)),\n    dC: Anim.Wait('', 7000).then(\n      AnimExtras.Measurement(\n        L.cMeasurementStart(tri),\n        L.cMeasurementEnd(tri),\n        20,\n        1600\n      )\n    ),\n    cOpacity: Anim.Wait(0, 8600).then(Anim.Ease(0, 1, 800)),\n  });\n}\n\ninterface MeasurementsState {\n  dA: string;\n  aOpacity: number;\n  dB: string;\n  bOpacity: number;\n  dC: string;\n  cOpacity: number;\n}\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import React from 'react';\nimport { Vec } from './tools';\n\nexport interface PolygonProps {\n  pts?: Vec[];\n  className?: string;\n  d?: string;\n  opacity?: number;\n}\n\nconst Polygon: React.FC<PolygonProps> = props => {\n  const { pts = [], className, opacity = 1 } = props;\n\n  const d = props.d\n    ? props.d\n    : `M ${pts.map(pt => `${pt.x} ${pt.y}`).join(' L ')} Z`;\n\n  return <path className={className} d={d} fillOpacity={opacity} />;\n};\n\nexport default Polygon;\n","import React from 'react';\nimport * as L from './locations';\nimport { StateContext, RightTriangle, Actions as A } from '../state';\nimport { useAnimationFrame } from '../hooks';\nimport { Anim, Extras as AnimExtras, Vec } from '../tools';\nimport Canvas from '../Canvas';\nimport Controls from '../Controls';\nimport ControlPoints from '../ControlPoints';\nimport MainTriangle from '../MainTriangle';\nimport Polygon from '../Polygon';\n\nconst Section: React.FC = () => {\n  const { dispatch } = React.useContext(StateContext);\n\n  function handleThin() {\n    return dispatch(A.makeThin());\n  }\n\n  function handleEven() {\n    return dispatch(A.makeEven());\n  }\n\n  return (\n    <section>\n      <h2>A Slight Reinterpretation</h2>\n\n      <p>\n        We'll begin by reinterpreting the statement{' '}\n        <code>\n          a<sup>2</sup> + b<sup>2</sup> = c<sup>2</sup>\n        </code>{' '}\n        ever so slightly. In particular, we've constructed squares using each of\n        the triangle's sides as a base. Since a square whose side length is{' '}\n        <code>s</code> has an area of{' '}\n        <code>\n          s<sup>2</sup>\n        </code>\n        , our new interpretation of the Pythagorean Theorem states that the two\n        smaller squares together have exactly the same area as the larger\n        square.\n      </p>\n\n      <p>This is what we'll demonstrate in the steps to come.</p>\n\n      <p>\n        Is this reasonable? When the triangle is thin, as in this{' '}\n        <button onClick={handleThin}>example</button>, the{' '}\n        <code>&ldquo;a&rdquo;</code> square is quite small, whereas the{' '}\n        <code>&ldquo;b&rdquo;</code> square is just slightly smaller than the{' '}\n        <code>&ldquo;c&rdquo;</code> square. As the triangle becomes thinner and\n        thinner (try it out!), this behavior is accentuated. For this reason,\n        the proposal seems plausible, at least for thin triangles. However, when\n        the triangle's sides are{' '}\n        <button onClick={handleEven}>roughly even</button>, it may be more\n        difficult to tell whether the total area of the smaller squares equals\n        that of the larger square.\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const squares = React.useMemo(() => animSquares(state.tri), [state.tri]);\n  const labels = React.useMemo(() => animLabels(state.tri), [state.tri]);\n\n  const totalDuration = Math.max(squares.duration, labels.duration);\n  const animControls = useAnimationFrame(totalDuration);\n  const { frame } = animControls;\n\n  const { dA, aOpacity, dB, bOpacity, dC, cOpacity } = squares.fn(frame);\n  const { aLabelOpacity, bLabelOpacity, cLabelOpacity } = labels.fn(frame);\n\n  const aLabelPos = L.aSquareLabel(state.tri);\n  const bLabelPos = L.bSquareLabel(state.tri);\n  const cLabelPos = L.cSquareLabel(state.tri);\n\n  return (\n    <>\n      <Canvas>\n        <Polygon className=\"main-square\" d={dA} opacity={aOpacity} />\n        <Polygon className=\"main-square\" d={dB} opacity={bOpacity} />\n        <Polygon className=\"main-square\" d={dC} opacity={cOpacity} />\n        <SquareLabel side=\"a\" pos={aLabelPos} opacity={aLabelOpacity} />\n        <SquareLabel side=\"b\" pos={bLabelPos} opacity={bLabelOpacity} />\n        <SquareLabel side=\"c\" pos={cLabelPos} opacity={cLabelOpacity} />\n        <MainTriangle />\n        <ControlPoints />\n      </Canvas>\n      <Controls {...animControls} />\n    </>\n  );\n};\n\ninterface SquareLabelProps {\n  side: string;\n  pos: Vec;\n  opacity: number;\n}\n\nconst SquareLabel: React.FC<SquareLabelProps> = props => {\n  const { side, pos, opacity } = props;\n\n  return (\n    <text\n      className=\"main-square-label\"\n      x={pos.x}\n      y={pos.y}\n      fillOpacity={opacity}\n      textAnchor=\"middle\"\n      dominantBaseline=\"middle\"\n    >\n      {side}\n      <tspan className=\"main-square-label-exponent\" dy=\"-1ex\">\n        2\n      </tspan>\n    </text>\n  );\n};\n\nfunction animSquares(tri: RightTriangle): Anim<SquaresState> {\n  return Anim.Fork({\n    dA: AnimExtras.SvgPath(L.aSquare(tri), 1600),\n    aOpacity: Anim.Wait(0, 1600).then(Anim.Ease(0, 1, 600)),\n    dB: AnimExtras.SvgPath(L.bSquare(tri), 1600),\n    bOpacity: Anim.Wait(0, 1600).then(Anim.Ease(0, 1, 600)),\n    dC: AnimExtras.SvgPath(L.cSquare(tri), 1600),\n    cOpacity: Anim.Wait(0, 1600).then(Anim.Ease(0, 1, 600)),\n  });\n}\n\ninterface SquaresState {\n  dA: string;\n  aOpacity: number;\n  dB: string;\n  bOpacity: number;\n  dC: string;\n  cOpacity: number;\n}\n\nfunction animLabels(tri: RightTriangle): Anim<LabelsState> {\n  return Anim.Fork({\n    aLabelOpacity: Anim.Wait(0, 2400).then(Anim.Ease(0, 1, 600)),\n    bLabelOpacity: Anim.Wait(0, 3000).then(Anim.Ease(0, 1, 600)),\n    cLabelOpacity: Anim.Wait(0, 3600).then(Anim.Ease(0, 1, 600)),\n  });\n}\n\ninterface LabelsState {\n  aLabelOpacity: number;\n  bLabelOpacity: number;\n  cLabelOpacity: number;\n}\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import React from 'react';\nimport * as L from './locations';\nimport { StateContext, RightTriangle } from '../state';\nimport { useAnimationFrame } from '../hooks';\nimport { Anim, Extras as AnimExtras } from '../tools';\nimport Canvas from '../Canvas';\nimport Controls from '../Controls';\nimport ControlPoints from '../ControlPoints';\nimport MainTriangle from '../MainTriangle';\nimport Polygon from '../Polygon';\nimport Measurement from '../Measurement';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h2>Computing Areas (1)</h2>\n\n      <p>\n        What are the areas of these auxiliary squares? We can see that the one\n        containing the two smaller squares has a side length of{' '}\n        <code>a + b</code>, so its area is{' '}\n        <code>\n          (a + b)<sup>2</sup>\n        </code>\n        .\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const measurements = React.useMemo(\n    () => animMeasurements(state.tri),\n    [state.tri]\n  );\n\n  const animControls = useAnimationFrame(measurements.duration);\n  const { frame } = animControls;\n\n  const { dA1, a1Opacity, dB1, b1Opacity, dA2, a2Opacity, dB2, b2Opacity } =\n    measurements.fn(frame);\n  const aLabel1Pos = L.aSquareMeasurement1Label(state.tri);\n  const bLabel1Pos = L.bSquareMeasurement1Label(state.tri);\n  const aLabel2Pos = L.aSquareMeasurement2Label(state.tri);\n  const bLabel2Pos = L.bSquareMeasurement2Label(state.tri);\n\n  return (\n    <>\n      <Canvas>\n        <Polygon className=\"main-square\" pts={L.aSquare(state.tri)} />\n        <Polygon className=\"main-square\" pts={L.bSquare(state.tri)} />\n        <Polygon className=\"main-square dim\" pts={L.cSquare(state.tri)} />\n        <MainTriangle />\n        <Polygon className=\"aux-square\" pts={L.abAuxSquare(state.tri)} />\n\n        <Measurement\n          d={dA1}\n          label=\"a\"\n          labelPos={aLabel1Pos}\n          labelOpacity={a1Opacity}\n        />\n        <Measurement\n          d={dB1}\n          label=\"b\"\n          labelPos={bLabel1Pos}\n          labelOpacity={b1Opacity}\n        />\n        <Measurement\n          d={dA2}\n          label=\"a\"\n          labelPos={aLabel2Pos}\n          labelOpacity={a2Opacity}\n        />\n        <Measurement\n          d={dB2}\n          label=\"b\"\n          labelPos={bLabel2Pos}\n          labelOpacity={b2Opacity}\n        />\n\n        <ControlPoints />\n      </Canvas>\n\n      <Controls {...animControls} />\n    </>\n  );\n};\n\nfunction animMeasurements(tri: RightTriangle): Anim<MeasurementsState> {\n  return Anim.Fork({\n    dA1: AnimExtras.Measurement(\n      L.aSquareMeasurement1Start(tri),\n      L.aSquareMeasurement1End(tri),\n      20,\n      1600\n    ),\n    a1Opacity: Anim.Wait(0, 1600).then(Anim.Ease(0, 1, 800)),\n    dB1: Anim.Wait('', 2000).then(\n      AnimExtras.Measurement(\n        L.bSquareMeasurement1Start(tri),\n        L.bSquareMeasurement1End(tri),\n        20,\n        1600\n      )\n    ),\n    b1Opacity: Anim.Wait(0, 3600).then(Anim.Ease(0, 1, 800)),\n    dA2: AnimExtras.Measurement(\n      L.aSquareMeasurement2Start(tri),\n      L.aSquareMeasurement2End(tri),\n      20,\n      1600\n    ),\n    a2Opacity: Anim.Wait(0, 1600).then(Anim.Ease(0, 1, 800)),\n    dB2: Anim.Wait('', 2000).then(\n      AnimExtras.Measurement(\n        L.bSquareMeasurement2Start(tri),\n        L.bSquareMeasurement2End(tri),\n        20,\n        1600\n      )\n    ),\n    b2Opacity: Anim.Wait(0, 3600).then(Anim.Ease(0, 1, 800)),\n  });\n}\n\ninterface MeasurementsState {\n  dA1: string;\n  a1Opacity: number;\n  dB1: string;\n  b1Opacity: number;\n  dA2: string;\n  a2Opacity: number;\n  dB2: string;\n  b2Opacity: number;\n}\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import React from 'react';\nimport { Vec, Pose } from './tools';\n\nexport interface PosedPolygonProps {\n  // These are the coordinates of the polygon's points in _object space_\n  pts: Vec[];\n  // This is the location and orientation of the polygon in _world space_\n  pose: Pose;\n  opacity?: number;\n  className?: string;\n}\n\nconst PosedPolygon: React.FC<PosedPolygonProps> = props => {\n  const { pose, opacity = 1, className } = props;\n\n  const pts = props.pts.map(pt => pt.rotate(pose.angle).plus(pose.loc));\n  const d = `M ${pts.map(pt => `${pt.x} ${pt.y}`).join(' L ')} Z`;\n\n  return <path className={className} d={d} fillOpacity={opacity} />;\n};\n\nexport default PosedPolygon;\n","import React from 'react';\nimport * as L from './locations';\nimport { StateContext, RightTriangle } from '../state';\nimport { useAnimationFrame } from '../hooks';\nimport { Anim, Pose } from '../tools';\nimport Canvas from '../Canvas';\nimport Controls from '../Controls';\nimport ControlPoints from '../ControlPoints';\nimport MainTriangle from '../MainTriangle';\nimport Polygon from '../Polygon';\nimport PosedPolygon from '../PosedPolygon';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h2>Considering the Leftovers (2)</h2>\n\n      <p>\n        The original right triangle is <em>also</em> copied 4 times within this\n        auxiliary square. Removing these 4 triangles leaves nothing but the two\n        squares with areas{' '}\n        <code>\n          a<sup>2</sup>\n        </code>{' '}\n        and{' '}\n        <code>\n          b<sup>2</sup>\n        </code>\n        ...\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const triCopies = React.useMemo(() => animTriCopies(state.tri), [state.tri]);\n\n  const animControls = useAnimationFrame(triCopies.duration);\n  const { frame } = animControls;\n\n  const {\n    tri1Pose,\n    tri1Opacity,\n    tri2Pose,\n    tri2Opacity,\n    tri3Pose,\n    tri3Opacity,\n    mainTriOpacity,\n  } = triCopies.fn(frame);\n  const triPts = L.triCopyPts(state.tri);\n\n  return (\n    <>\n      <Canvas>\n        <Polygon className=\"main-square\" pts={L.aSquare(state.tri)} />\n        <Polygon className=\"main-square\" pts={L.bSquare(state.tri)} />\n        <Polygon className=\"main-square dim\" pts={L.cSquare(state.tri)} />\n\n        <MainTriangle opacity={mainTriOpacity} strokeOpacity={mainTriOpacity} />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={tri1Pose}\n          opacity={tri1Opacity}\n        />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={tri2Pose}\n          opacity={tri2Opacity}\n        />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={tri3Pose}\n          opacity={tri3Opacity}\n        />\n\n        <Polygon className=\"aux-square\" pts={L.abAuxSquare(state.tri)} />\n        <ControlPoints />\n      </Canvas>\n\n      <Controls {...animControls} />\n    </>\n  );\n};\n\nfunction animTriCopies(tri: RightTriangle): Anim<TriCopiesState> {\n  const initPose = L.initTriPose(tri);\n  const copy1Pose = L.triCopyAB1Pose(tri);\n  const copy2Pose = L.triCopyAB2Pose(tri);\n  const copy3Pose = L.triCopyAB3Pose(tri);\n\n  return Anim.Fork({\n    tri1Pose: Anim.Ease(initPose, copy1Pose, 1600),\n    tri1Opacity: Anim.Ease(0, 1, 400)\n      .then(Anim.Wait(1, 5600))\n      .then(Anim.Ease(1, 0, 1200)),\n    tri2Pose: Anim.Wait(copy1Pose, 1800).then(\n      Anim.Ease(copy1Pose, copy2Pose, 1600)\n    ),\n    tri2Opacity: Anim.Wait(0, 1800)\n      .then(Anim.Ease(0, 1, 400))\n      .then(Anim.Wait(1, 3800))\n      .then(Anim.Ease(1, 0, 1200)),\n    tri3Pose: Anim.Wait(copy2Pose, 3600).then(\n      Anim.Ease(copy2Pose, copy3Pose, 1600)\n    ),\n    tri3Opacity: Anim.Wait(0, 3600)\n      .then(Anim.Ease(0, 1, 400))\n      .then(Anim.Wait(1, 2000))\n      .then(Anim.Ease(1, 0, 1200)),\n    mainTriOpacity: Anim.Wait(1, 6000).then(Anim.Ease(1, 0, 1200)),\n  });\n}\n\ninterface TriCopiesState {\n  tri1Pose: Pose;\n  tri1Opacity: number;\n  tri2Pose: Pose;\n  tri2Opacity: number;\n  tri3Pose: Pose;\n  tri3Opacity: number;\n  mainTriOpacity: number;\n}\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import step1 from './step1';\nimport step2 from './step2';\nimport step3 from './step3';\nimport step4 from './step4';\nimport step5 from './step5';\nimport step6 from './step6';\nimport step7 from './step7';\nimport step8 from './step8';\nimport step9 from './step9';\n\nexport * as Locations from './locations';\n\nexport const steps: Step[] = [\n  step1,\n  step2,\n  step3,\n  step4,\n  step5,\n  step6,\n  step7,\n  step8,\n  step9,\n];\n\nexport interface Step {\n  section: React.FC;\n  graphics: React.FC;\n}\n","import React from 'react';\nimport * as L from './locations';\nimport { StateContext, RightTriangle } from '../state';\nimport { useAnimationFrame } from '../hooks';\nimport { Anim, Extras as AnimExtras } from '../tools';\nimport Canvas from '../Canvas';\nimport Controls from '../Controls';\nimport ControlPoints from '../ControlPoints';\nimport MainTriangle from '../MainTriangle';\nimport Polygon from '../Polygon';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h2>Some Auxiliary Elements</h2>\n\n      <p>\n        To start, we construct two larger squares around our original right\n        triangle: one containing the <code>&ldquo;c&rdquo;</code> square, and\n        the other containing the two smaller squares.\n      </p>\n\n      <p>\n        Curiously enough, both of these &ldquo;auxiliary&rdquo; squares appear\n        to have the same area. Is this the case? If so, can you see why? We'll\n        look at these questions next.\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const auxSquares = React.useMemo(\n    () => animAuxSquares(state.tri),\n    [state.tri]\n  );\n\n  const animControls = useAnimationFrame(auxSquares.duration);\n  const { frame } = animControls;\n\n  const { abPath, cPath } = auxSquares.fn(frame);\n\n  return (\n    <>\n      <Canvas>\n        <Polygon className=\"main-square\" pts={L.aSquare(state.tri)} />\n        <Polygon className=\"main-square\" pts={L.bSquare(state.tri)} />\n        <Polygon className=\"main-square\" pts={L.cSquare(state.tri)} />\n        <MainTriangle />\n        <Polygon className=\"aux-square\" d={abPath} />\n        <Polygon className=\"aux-square\" d={cPath} />\n        <ControlPoints />\n      </Canvas>\n\n      <Controls {...animControls} />\n    </>\n  );\n};\n\nfunction animAuxSquares(tri: RightTriangle): Anim<AuxSquaresState> {\n  return Anim.Fork({\n    abPath: AnimExtras.SvgPath(L.abAuxSquare(tri), 1600),\n    cPath: Anim.Wait('', 1600).then(\n      AnimExtras.SvgPath(L.cAuxSquare(tri), 1600)\n    ),\n  });\n}\n\ninterface AuxSquaresState {\n  abPath: string;\n  cPath: string;\n}\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import React from 'react';\nimport * as L from './locations';\nimport { StateContext, RightTriangle } from '../state';\nimport { useAnimationFrame } from '../hooks';\nimport { Anim, Pose, Extras as AnimExtras } from '../tools';\nimport Canvas from '../Canvas';\nimport Controls from '../Controls';\nimport ControlPoints from '../ControlPoints';\nimport MainTriangle from '../MainTriangle';\nimport Polygon from '../Polygon';\nimport PosedPolygon from '../PosedPolygon';\nimport Measurement from '../Measurement';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h2>Computing Areas (2)</h2>\n\n      <p>\n        The area of the second auxiliar square is a bit trickier to compute.\n        However, once we see that our original right triangle appears\n        &ldquo;copied&rdquo; within the square, it's clear that the square's\n        sides have length <code>a + b</code>. Accordingly, its area is{' '}\n        <code>\n          (a + b)<sup>2</sup>\n        </code>{' '}\n        as well.\n      </p>\n\n      <p>\n        This confirms what we first suspected several steps back. Now that we\n        know that the auxiliary squares have the same area, we're ready for the\n        final steps.\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const triCopies = React.useMemo(() => animTriCopies(state.tri), [state.tri]);\n  const measurements = React.useMemo(\n    () => animMeasurements(state.tri),\n    [state.tri]\n  );\n\n  const animControls = useAnimationFrame(measurements.duration);\n  const { frame } = animControls;\n\n  const {\n    tri1Pose,\n    tri1Opacity,\n    tri2Pose,\n    tri2Opacity,\n    tri3Pose,\n    tri3Opacity,\n  } = triCopies.fn(frame);\n  const triPts = L.triCopyPts(state.tri);\n\n  const { dA1, a1Opacity, dB1, b1Opacity, dA2, a2Opacity, dB2, b2Opacity } =\n    measurements.fn(frame);\n  const aLabel1Pos = L.cSquareMeasurementA1Label(state.tri);\n  const bLabel1Pos = L.cSquareMeasurementB1Label(state.tri);\n  const aLabel2Pos = L.cSquareMeasurementA2Label(state.tri);\n  const bLabel2Pos = L.cSquareMeasurementB2Label(state.tri);\n\n  return (\n    <>\n      <Canvas>\n        <Polygon className=\"main-square dim\" pts={L.aSquare(state.tri)} />\n        <Polygon className=\"main-square dim\" pts={L.bSquare(state.tri)} />\n        <Polygon className=\"main-square\" pts={L.cSquare(state.tri)} />\n        <MainTriangle />\n\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={tri1Pose}\n          opacity={tri1Opacity}\n        />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={tri2Pose}\n          opacity={tri2Opacity}\n        />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={tri3Pose}\n          opacity={tri3Opacity}\n        />\n\n        <Measurement\n          d={dA1}\n          label=\"a\"\n          labelPos={aLabel1Pos}\n          labelOpacity={a1Opacity}\n        />\n        <Measurement\n          d={dB1}\n          label=\"b\"\n          labelPos={bLabel1Pos}\n          labelOpacity={b1Opacity}\n        />\n        <Measurement\n          d={dA2}\n          label=\"a\"\n          labelPos={aLabel2Pos}\n          labelOpacity={a2Opacity}\n        />\n        <Measurement\n          d={dB2}\n          label=\"b\"\n          labelPos={bLabel2Pos}\n          labelOpacity={b2Opacity}\n        />\n\n        <Polygon className=\"aux-square\" pts={L.cAuxSquare(state.tri)} />\n        <ControlPoints />\n      </Canvas>\n\n      <Controls {...animControls} />\n    </>\n  );\n};\n\nfunction animTriCopies(tri: RightTriangle): Anim<TriCopiesState> {\n  const initPose = L.initTriPose(tri);\n  const copy1Pose = L.triCopyC1Pose(tri);\n  const copy2Pose = L.triCopyC2Pose(tri);\n  const copy3Pose = L.triCopyC3Pose(tri);\n\n  return Anim.Fork({\n    tri1Pose: Anim.Ease(initPose, copy1Pose, 1600),\n    tri1Opacity: Anim.Ease(0, 1, 400),\n    tri2Pose: Anim.Wait(copy1Pose, 1800).then(\n      Anim.Ease(copy1Pose, copy2Pose, 1600)\n    ),\n    tri2Opacity: Anim.Wait(0, 1800).then(Anim.Ease(0, 1, 400)),\n    tri3Pose: Anim.Wait(copy2Pose, 3600).then(\n      Anim.Ease(copy2Pose, copy3Pose, 1600)\n    ),\n    tri3Opacity: Anim.Wait(0, 3600).then(Anim.Ease(0, 1, 400)),\n  });\n}\n\ninterface TriCopiesState {\n  tri1Pose: Pose;\n  tri1Opacity: number;\n  tri2Pose: Pose;\n  tri2Opacity: number;\n  tri3Pose: Pose;\n  tri3Opacity: number;\n}\n\nfunction animMeasurements(tri: RightTriangle): Anim<MeasurementsState> {\n  return Anim.Fork({\n    dA1: Anim.Wait('', 5600).then(\n      AnimExtras.Measurement(\n        L.cSquareMeasurementA1Start(tri),\n        L.cSquareMeasurementA1End(tri),\n        20,\n        1600\n      )\n    ),\n    a1Opacity: Anim.Wait(0, 7200).then(Anim.Ease(0, 1, 800)),\n    dB1: Anim.Wait('', 7600).then(\n      AnimExtras.Measurement(\n        L.cSquareMeasurementB1Start(tri),\n        L.cSquareMeasurementB1End(tri),\n        20,\n        1600\n      )\n    ),\n    b1Opacity: Anim.Wait(0, 9200).then(Anim.Ease(0, 1, 800)),\n    dA2: Anim.Wait('', 5600).then(\n      AnimExtras.Measurement(\n        L.cSquareMeasurementA2Start(tri),\n        L.cSquareMeasurementA2End(tri),\n        20,\n        1600\n      )\n    ),\n    a2Opacity: Anim.Wait(0, 7200).then(Anim.Ease(0, 1, 800)),\n    dB2: Anim.Wait('', 7600).then(\n      AnimExtras.Measurement(\n        L.cSquareMeasurementB2Start(tri),\n        L.cSquareMeasurementB2End(tri),\n        20,\n        1600\n      )\n    ),\n    b2Opacity: Anim.Wait(0, 9200).then(Anim.Ease(0, 1, 800)),\n  });\n}\n\ninterface MeasurementsState {\n  dA1: string;\n  a1Opacity: number;\n  dB1: string;\n  b1Opacity: number;\n  dA2: string;\n  a2Opacity: number;\n  dB2: string;\n  b2Opacity: number;\n}\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import React from 'react';\nimport * as L from './locations';\nimport { StateContext, RightTriangle } from '../state';\nimport { useAnimationFrame } from '../hooks';\nimport { Anim } from '../tools';\nimport Canvas from '../Canvas';\nimport Controls from '../Controls';\nimport ControlPoints from '../ControlPoints';\nimport MainTriangle from '../MainTriangle';\nimport Polygon from '../Polygon';\nimport PosedPolygon from '../PosedPolygon';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h2>Considering the Leftovers (1)</h2>\n\n      <p>\n        We just saw that this auxiliary square contains 4 copies of the original\n        right triangle, along with the square whose area is{' '}\n        <code>\n          c<sup>2</sup>\n        </code>\n        . As a result, if we\n        <em>remove</em> the four copies of the right triangle, the remaining\n        area is simply{' '}\n        <code>\n          c<sup>2</sup>\n        </code>\n        .\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const opacity = React.useMemo(() => animOpacity(state.tri), [state.tri]);\n\n  const animControls = useAnimationFrame(opacity.duration);\n  const { frame } = animControls;\n\n  const { triOpacity } = opacity.fn(frame);\n  const triPts = L.triCopyPts(state.tri);\n\n  return (\n    <>\n      <Canvas>\n        <Polygon className=\"main-square dim\" pts={L.aSquare(state.tri)} />\n        <Polygon className=\"main-square dim\" pts={L.bSquare(state.tri)} />\n        <Polygon className=\"main-square\" pts={L.cSquare(state.tri)} />\n\n        <MainTriangle opacity={triOpacity} strokeOpacity={triOpacity} />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={L.triCopyC1Pose(state.tri)}\n          opacity={triOpacity}\n        />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={L.triCopyC2Pose(state.tri)}\n          opacity={triOpacity}\n        />\n        <PosedPolygon\n          className=\"main-triangle-copy\"\n          pts={triPts}\n          pose={L.triCopyC3Pose(state.tri)}\n          opacity={triOpacity}\n        />\n\n        <Polygon className=\"aux-square\" pts={L.cAuxSquare(state.tri)} />\n        <ControlPoints />\n      </Canvas>\n\n      <Controls {...animControls} />\n    </>\n  );\n};\n\nfunction animOpacity(tri: RightTriangle): Anim<OpacityState> {\n  return Anim.Fork({\n    triOpacity: Anim.Ease(1, 0, 1200),\n  });\n}\n\ninterface OpacityState {\n  triOpacity: number;\n}\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import React from 'react';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h2>Putting It All Together</h2>\n\n      <p>\n        In other words, the area of the first auxiliary square is{' '}\n        <code>\n          a<sup>2</sup> + b<sup>2</sup> + 4A\n        </code>{' '}\n        (where <code>A</code> is the area of the right triangle), and the area\n        of the second auxiliary square is{' '}\n        <code>\n          c<sup>2</sup> + 4A\n        </code>\n        . But the two auxiliary square have <em>the same area</em>, so these two\n        expressions are equal:{' '}\n        <code>\n          a<sup>2</sup> + b<sup>2</sup> + 4A = c<sup>2</sup> + 4A\n        </code>\n        .\n      </p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  return null;\n};\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import React from 'react';\n\nconst Section: React.FC = () => {\n  return (\n    <section>\n      <h2>Epilogue: Is This a Proof?</h2>\n\n      <p></p>\n    </section>\n  );\n};\n\nconst Graphics: React.FC = () => {\n  return null;\n};\n\nconst step = {\n  section: Section,\n  graphics: Graphics,\n};\n\nexport default step;\n","import { State, Dims, initTri } from './state';\nimport { Action, ActionType } from './actions';\nimport { steps } from '../steps';\nimport { DragSubject } from './DragSubject';\nimport { Vec, sign } from '../tools';\n\nexport function reducer(state: State, action: Action): State {\n  switch (action.type) {\n    case ActionType.PreviousStep:\n      return reducePreviousStep(state);\n    case ActionType.NextStep:\n      return reduceNextStep(state);\n    case ActionType.MouseDownRVertex:\n      return reduceMouseDownRVertex(state);\n    case ActionType.MouseDownHVertex:\n      return reduceMouseDownHVertex(state);\n    case ActionType.MouseDownVVertex:\n      return reduceMouseDownVVertex(state);\n    case ActionType.MouseMove:\n      return reduceMouseMove(state, action.payload);\n    case ActionType.MouseUp:\n      return reduceMouseUp(state);\n    case ActionType.MakeThin:\n      return reduceMakeThin(state);\n    case ActionType.MakeEven:\n      return reduceMakeEven(state);\n    case ActionType.UpdateDims:\n      return reduceUpdateDims(state, action.payload);\n    case ActionType.ResetMainTriangle:\n      return reduceResetMainTriangle(state);\n    default:\n      return state;\n  }\n}\n\nfunction reducePreviousStep(state: State): State {\n  return { ...state, stepIndex: Math.max(0, state.stepIndex - 1) };\n}\n\nfunction reduceNextStep(state: State): State {\n  return {\n    ...state,\n    stepIndex: Math.min(steps.length - 1, state.stepIndex + 1),\n  };\n}\n\nfunction reduceMouseDownRVertex(state: State): State {\n  const { r, h, v } = state.tri;\n  const hOffset = h.x - r.x;\n  const vOffset = v.y - r.y;\n\n  return { ...state, dragSubject: DragSubject.RVertex(hOffset, vOffset) };\n}\n\nfunction reduceMouseDownHVertex(state: State): State {\n  return { ...state, dragSubject: DragSubject.HVertex() };\n}\n\nfunction reduceMouseDownVVertex(state: State): State {\n  return { ...state, dragSubject: DragSubject.VVertex() };\n}\n\nfunction reduceMouseMove(state: State, mousePos: Vec): State {\n  return state.dragSubject.match({\n    none: () => state,\n    r: (hOffset, vOffset) => moveRVertex(state, hOffset, vOffset, mousePos),\n    h: () => moveHVertex(state, mousePos),\n    v: () => moveVVertex(state, mousePos),\n  });\n}\n\nfunction moveRVertex(\n  state: State,\n  hOffset: number,\n  vOffset: number,\n  mousePos: Vec\n): State {\n  const h = new Vec(mousePos.x + hOffset, mousePos.y);\n  const v = new Vec(mousePos.x, mousePos.y + vOffset);\n  return { ...state, tri: { r: mousePos, h, v } };\n}\n\nconst VERTEX_PADDING = 40;\n\nfunction moveHVertex(state: State, mousePos: Vec): State {\n  const { r, v } = state.tri;\n\n  const hX =\n    Math.abs(mousePos.x - r.x) < VERTEX_PADDING\n      ? r.x + VERTEX_PADDING * sign(mousePos.x - r.x)\n      : mousePos.x;\n  const hY =\n    Math.abs(mousePos.y - v.y) < VERTEX_PADDING\n      ? v.y + VERTEX_PADDING * sign(mousePos.y - v.y)\n      : mousePos.y;\n\n  const newH = new Vec(hX, hY);\n  const newR = new Vec(r.x, hY);\n\n  return { ...state, tri: { ...state.tri, r: newR, h: newH } };\n}\n\nfunction moveVVertex(state: State, mousePos: Vec): State {\n  const { r, h } = state.tri;\n\n  const vX =\n    Math.abs(mousePos.x - h.x) < VERTEX_PADDING\n      ? h.x + VERTEX_PADDING * sign(mousePos.x - h.x)\n      : mousePos.x;\n  const vY =\n    Math.abs(mousePos.y - r.y) < VERTEX_PADDING\n      ? r.y + VERTEX_PADDING * sign(mousePos.y - r.y)\n      : mousePos.y;\n\n  const newV = new Vec(vX, vY);\n  const newR = new Vec(vX, r.y);\n\n  return { ...state, tri: { ...state.tri, r: newR, v: newV } };\n}\n\nfunction reduceMouseUp(state: State): State {\n  const triOutOfBounds = isTriOutOfBounds(state, state.ui.dims);\n  return {\n    ...state,\n    ui: { ...state.ui, triOutOfBounds },\n    dragSubject: DragSubject.None(),\n  };\n}\n\nfunction reduceMakeThin(state: State): State {\n  const r = new Vec(-80, 0);\n  const h = new Vec(80, r.y);\n  const v = new Vec(r.x, -VERTEX_PADDING);\n\n  return { ...state, tri: { ...state.tri, r, h, v } };\n}\n\nfunction reduceMakeEven(state: State): State {\n  const r = new Vec(0, 20);\n  // \"roughly\" even\n  const h = new Vec(90, r.y);\n  const v = new Vec(r.x, -80);\n\n  return { ...state, tri: { ...state.tri, r, h, v } };\n}\n\nfunction reduceUpdateDims(state: State, dims: Dims): State {\n  const triOutOfBounds = isTriOutOfBounds(state, dims);\n  return { ...state, ui: { ...state.ui, dims, triOutOfBounds } };\n}\n\nfunction reduceResetMainTriangle(state: State): State {\n  return { ...state, tri: initTri, ui: { ...state.ui, triOutOfBounds: false } };\n}\n\nfunction isTriOutOfBounds(state: State, dims: Dims): boolean {\n  const { r } = state.tri;\n  const { width, height } = dims;\n\n  const outX = Math.abs(r.x) > width / 2;\n  const outY = Math.abs(r.y) > height / 2;\n  return outX || outY;\n}\n","import { State, Dims } from './state';\nimport { steps } from '../steps';\n\nexport function canGoPrevious(state: State): boolean {\n  return state.stepIndex > 0;\n}\n\nexport function canGoNext(state: State): boolean {\n  return state.stepIndex < steps.length - 1;\n}\n\nexport function stepProgress(state: State): string {\n  return `${state.stepIndex + 1} / ${steps.length}`;\n}\n\nexport function currentSection(state: State): React.FC {\n  return steps[state.stepIndex].section;\n}\n\nexport function currentGraphics(state: State): React.FC {\n  return steps[state.stepIndex].graphics;\n}\n\nexport function isTriOutOfBounds(state: State): boolean {\n  return state.ui.triOutOfBounds;\n}\n\nexport function dims(state: State): Dims {\n  return state.ui.dims;\n}\n","import React from 'react';\nimport { initState } from './state';\nimport { Action } from './actions';\n\nexport * from './state';\nexport * from './reducer';\nexport * as Actions from './actions';\nexport * as Selectors from './selectors';\n\nexport const StateContext = React.createContext({\n  state: initState,\n  dispatch: null as any as React.Dispatch<Action>,\n});\n","export default __webpack_public_path__ + \"static/media/sonobe.cfe1c59c.svg\";","import React from 'react';\nimport sonobe from './assets/sonobe.svg';\n\nconst Header: React.FC = () => {\n  return (\n    <header>\n      <nav>\n        <a href=\"https://wjlewis.github.io\" target=\"_blank\" rel=\"noreferrer\">\n          <img id=\"icon\" src={sonobe} alt=\"A sonobe module\" />\n        </a>\n\n        <a\n          href=\"https://www.github.com/wjlewis/pymos\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          Source\n        </a>\n      </nav>\n    </header>\n  );\n};\n\nexport default Header;\n","import React from 'react';\nimport { StateContext, Selectors as S } from './state';\n\nconst Prose: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const Section = S.currentSection(state);\n\n  return (\n    <article id=\"prose\">\n      <Section />\n    </article>\n  );\n};\n\nexport default Prose;\n","import React from 'react';\nimport { StateContext, Actions as A, Selectors as S } from './state';\n\nconst MainTriangleReset: React.FC = () => {\n  const { state, dispatch } = React.useContext(StateContext);\n\n  function handleReset() {\n    return dispatch(A.resetMainTriangle());\n  }\n\n  if (S.isTriOutOfBounds(state)) {\n    return (\n      <div id=\"main-triangle-reset\">\n        <button onClick={handleReset}>Reset Triangle</button>\n      </div>\n    );\n  } else {\n    return null;\n  }\n};\n\nexport default MainTriangleReset;\n","import React from 'react';\nimport { StateContext, Selectors as S } from './state';\nimport MainTriangleReset from './MainTriangleReset';\n\nconst Illustration: React.FC = () => {\n  const { state } = React.useContext(StateContext);\n\n  const Graphics = S.currentGraphics(state);\n\n  return (\n    <article id=\"illustration\">\n      <Graphics />\n      <MainTriangleReset />\n    </article>\n  );\n};\n\nexport default Illustration;\n","import React from 'react';\nimport { StateContext, Selectors as S, Actions as A } from './state';\n\nconst Footer: React.FC = () => {\n  const { state, dispatch } = React.useContext(StateContext);\n\n  const noPrevious = !S.canGoPrevious(state);\n  const noNext = !S.canGoNext(state);\n\n  function handlePrevious() {\n    return dispatch(A.previousStep());\n  }\n\n  function handleNext() {\n    return dispatch(A.nextStep());\n  }\n\n  return (\n    <footer>\n      <nav>\n        <button onClick={handlePrevious} disabled={noPrevious}>\n          Previous\n        </button>\n\n        <span>{S.stepProgress(state)}</span>\n\n        <button onClick={handleNext} disabled={noNext}>\n          Next\n        </button>\n      </nav>\n    </footer>\n  );\n};\n\nexport default Footer;\n","import React from 'react';\nimport { StateContext, initState, reducer } from './state';\nimport Header from './Header';\nimport Prose from './Prose';\nimport Illustration from './Illustration';\nimport Footer from './Footer';\n\nconst App: React.FC = () => {\n  const [state, dispatch] = React.useReducer(reducer, initState);\n\n  return (\n    <StateContext.Provider value={{ state, dispatch }}>\n      <Header />\n      <main>\n        <Prose />\n        <Illustration />\n      </main>\n      <Footer />\n    </StateContext.Provider>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}